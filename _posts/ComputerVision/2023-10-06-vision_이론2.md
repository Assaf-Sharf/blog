---
title: "Computer Vision 이론 1"
escerpt: "Computer Vision 이론 1"

categories:
  - Vision
tags:
  - [AI, Vision]

toc: true
toc_sticky: true

breadcrumbs: true

date: 2023-10-06
last_modified_at: 2023-10-06

comments: true
 

---

# 4. OpenCV, PIL, Matplotlib, Scikit-image : 이미지 읽어들이고 처리하는 많이 쓰이는 라이브러리

## 4-1. OpenCV
- 컴퓨터 비전 을 목적으로 하는 오픈 소스 라이브러리
- 인텔 CPU 에서 사용하는 경우 속도 향상을 볼 수 있는 IPP (Intel Performance Primitives) 를 지원한다.
-  기존에 C++ 에서 사용할 수 있게 구현되었으나, OpenCV-python 을 통해 python 포팅도 되어 있다.
-  단점: GPU operation 에 대한 지원을, 명시적으로 python 과 연계하여 하지는 않는다.
- 설치: pip install opencv-python 
- [OpenCV documentation](https://docs.opencv.org/4.x/)
- [penCV python tutorial](https://docs.opencv.org/4.x/d6/d00/tutorial_py_root.html)

### 4-1.1. Opencv 예시
1. Image read and visualize
2. multiple image visualize, figure/axs in matplotlib
3. image cropping, masking and save
4. Image matching and visualize

## 4-2. matplotlib

- Python 과 numpy array를 기반으로 plotting 과 visualize를 목적으로 하는 라이브러리
- 주어진 데이터에 대해서 차트와 plot 을 편리하게 그려주는 데이터
시각화 패키지 이다.
- 우리는 본 강의에서 이미지 시각화와 디버깅을 위해 사용한다.
- 설치 : pip install matplotlib
- [Matplotlib documentation](https://matplotlib.org/stable/index.html)
- [Mattploblit tutorials](https://matplotlib.org/stable/tutorials/index.html)
- [wikipedia-Matplotlib](https://ko.wikipedia.org/wiki/Matplotlib)


## 4-3. PIL

- PIL (Python Imaging Library) 로서 컴퓨터 비전 보다는 이미지 처리에 중점을 둔 라이브러리.
  - 컴퓨터 비전은 이미지 자체를 분석해서 classification이나 object를 찾는 결과를 desicion하는 것이 목적
  - 이미지처리는 이미지를 넣었을때 이미지가 어떻게 바뀔지를 찾는 컴퓨터 graphics에 가까운 task 이다.

- 픽셀단위의 이미지 조작이나, 마스킹, 투명도 제어, 윤곽 보정 및 검출 등의 다양한 이미지 조작을 할 수 있다.
  - downsampling
  - upsampling

- 설치 : pip install pillow
- [Pillow (PIL forked) documentation](https://pillow.readthedocs.io/en/stable)

### 4-3.1. PIL 예시
1. Image read and visualize
2. image cropping, rotating, scaling
3. Image interpolation(upsampling, downsampling)

## 4-4. Scikit-image

- Scikit-image 는 Pillow (PIL) 과 마찬가지로, 이미지 조작과 필터링이 가능하다.
- numpy 를 기반으로 동작하기 때문에, 좀 더 numpy와의 호환성이 좋다.
- 설치 : pip install scikit-image

```
from skimage import data, io, filters

image = data.coins()
# ... or any other NumPy array!
edges = filters.sobel(image)
io.imshow(edges)
io.show()
```

- [Scikit-image Documentation](https://scikit-image.org)

# 5. PyTorch, TorchVision and Kornia : 딥러닝 하기위한 프레임워크인 pytorch

## 5-1. Pytorch

- GPU와 CPU를 사용해서 deep learning 을 하기 위해 최적화된 tensor library이다.
- 원래 Lua라는 프로그래밍 언어로 된 Torch였으나, 오픈소스로 여러사람이
개발하다가 facebook AI 가 개발에 참여하면서, 사용성이 좋아지고 있다.
- PyTorch로 넘어오면서 특히 좋은 점은 자동 미분 모듈(auto gradient)이 있어서 따로 backward함수를 구현하지 않아도 된다는 점이다.
  - forward를 하면 gradient를 구한후 gradient descent algorithm으로 모델이 업데이트 진행된다. 실제적으로 backward할때 계산하지 않아도 pytorch에서는 작동이 된다.
- [모듈, tensorflow와의 비교, 장점](https://ko.wikipedia.org/wiki/PyTorch)

  - tensorflow 특징
  : 그래프를 먼저 만들고 한번 어떤 data를 통과시킨 다음에 static한 그래프로 바꾸기 까다롭다.
  - pytorch 특징 
  : 그때그때 layer를 추가할수 있어서 dynamic한 그래프를 만들어서 computation을 구축하고 마지막에 output을 만드는 형태이다.

- [pytorch 설치방법](https://pytorch.org/get-started/locally/)
- [PyTorch documentation](https://pytorch.org/docs/stable/index.html)
- [PyTorch tutorial](https://pytorch.org/tutorials)


## 5-2. TorchVision

- PyTorch project 의 일부로서 이미지를 처리하는 다양한 인터페이스(함수, 클래스…)를 제공한다.
- Numpy array (또는 PIL) 이미지의 torch.Tensor type으로의 형변환해주는 함수 (transforms.ToPILImage(), transforms.ToTensor())와, image를 자르거나 photometric jitering을 주는 등의data augmentation 기능을 제공한다.
- 또한, 대표적인 CNN model(ResNet, Dense layer, VGG 등)과 그 pre-trained weights을 쉽게 사용하도록 해준다.
- 설치: 보통 pytorch 설치할 때에 같이 설치한다.
- [TorchVision documentation](https://pytorch.org/vision/stable/index.html)
- 추가적으로 image augmentation 할 때에 사용하는 albumentations 라이브러리가 있다.  
  - torchvision에서의 augmentation이 한계가 있을수 있기에 추가 라이브러리를 활용하면 조금 더 좋다.
- [albumentation 예시](https://albumentations.ai/)
- [albumentation Documentation](https://albumentations.ai/docs)

## 5-3. Anaconda

- 아나콘다 : 패키지 (라이브러리 및 dependencies) 관리를 쉽게하기 위해 사용하는 오픈소스 패키지 관리 시스템.
- 도커나 다른 방식을 사용하기도 하지만, 보통 anaconda 를 사용한 패키지 관리가 간단하고 편리하기에 많이 사용한다.
-  Conda 와 같은 package manager를 쓰면 프로젝트마다 패키지나 버전 관리가 간단하고, 프로그래밍 그 자체에 좀 더 집중할 수 있게 도와준다.
- [설치방법](https://www.anaconda.com/products/individual)
- 위에서 installer 설치 후 
  - bash Anaconda-latest-Linux-x86_64.sh 또는 GUI 로 설치.
- 새로운 environment 만들기
```
$ conda create –n {desired name} python={desired version}
```

- Using an environment

```
 $ conda activate {desired env name} 
 $ conda deactivate {desired env name} 
```

- Remove an environment
```
conda remove –n {desired env name} --all 
```

- [anaconda More informations](https://docs.conda.io/projects/conda/en/latest/user-guide/install/index.ht)


## 5-4. 실습
Installation
Tensors
Dataloader(Loading data)
Network(Build the neural network)
Training
Save and Load Model Weights
Transfer learning(with torchvision model)

# 6. Loggig, Wandb : logging은 중간중간 기록하는것. deep learning logging tool인 wandb를 활용해서 어떻게 디버깅할지




# Classical computer vision



# Deep learning
# Representation learning
# Object detection & segmentation
# Video
# Multiview geometry
# 3D Vision
# Generative models and graphics


---


[맨 위로 이동하기](#){: .btn .btn--primary }{: .align-right}