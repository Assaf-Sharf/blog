## 코로나 : 시각화를 통한 인사이트 도출

### 1. 준비.


```python
# 필요한 라이브러리를 가져온다.
import pandas as pd
import numpy as np
import seaborn as sns
import scipy.stats as st
import matplotlib.pyplot as plt

from sklearn.preprocessing import StandardScaler 
from sklearn.cluster import KMeans
from sklearn.decomposition import PCA
```


```python
# Pandas 데이터 프레임에서 float을 소수점 2자리 까지 출력해 준다.
#pd.set_option('display.float_format', lambda x: '%.2f' % x)
pd.set_option("precision",4)
```


```python
# 성가신 경고를 꺼준다.
import warnings  
warnings.filterwarnings('ignore')
```


```python
# 환자정보 데이터를 불러온다.
df1 = pd.read_csv(r'.\data\PatientInfo.csv')
```


```python
df1.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>patient_id</th>
      <th>global_num</th>
      <th>sex</th>
      <th>birth_year</th>
      <th>age</th>
      <th>country</th>
      <th>province</th>
      <th>city</th>
      <th>disease</th>
      <th>infection_case</th>
      <th>infection_order</th>
      <th>infected_by</th>
      <th>contact_number</th>
      <th>symptom_onset_date</th>
      <th>confirmed_date</th>
      <th>released_date</th>
      <th>deceased_date</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000000001</td>
      <td>2.0</td>
      <td>male</td>
      <td>1964</td>
      <td>50s</td>
      <td>Korea</td>
      <td>Seoul</td>
      <td>Gangseo-gu</td>
      <td>NaN</td>
      <td>overseas inflow</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>75</td>
      <td>2020-01-22</td>
      <td>2020-01-23</td>
      <td>2020-02-05</td>
      <td>NaN</td>
      <td>released</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000000002</td>
      <td>5.0</td>
      <td>male</td>
      <td>1987</td>
      <td>30s</td>
      <td>Korea</td>
      <td>Seoul</td>
      <td>Jungnang-gu</td>
      <td>NaN</td>
      <td>overseas inflow</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>31</td>
      <td>NaN</td>
      <td>2020-01-30</td>
      <td>2020-03-02</td>
      <td>NaN</td>
      <td>released</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000000003</td>
      <td>6.0</td>
      <td>male</td>
      <td>1964</td>
      <td>50s</td>
      <td>Korea</td>
      <td>Seoul</td>
      <td>Jongno-gu</td>
      <td>NaN</td>
      <td>contact with patient</td>
      <td>2.0</td>
      <td>2002000001</td>
      <td>17</td>
      <td>NaN</td>
      <td>2020-01-30</td>
      <td>2020-02-19</td>
      <td>NaN</td>
      <td>released</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000000004</td>
      <td>7.0</td>
      <td>male</td>
      <td>1991</td>
      <td>20s</td>
      <td>Korea</td>
      <td>Seoul</td>
      <td>Mapo-gu</td>
      <td>NaN</td>
      <td>overseas inflow</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>9</td>
      <td>2020-01-26</td>
      <td>2020-01-30</td>
      <td>2020-02-15</td>
      <td>NaN</td>
      <td>released</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000000005</td>
      <td>9.0</td>
      <td>female</td>
      <td>1992</td>
      <td>20s</td>
      <td>Korea</td>
      <td>Seoul</td>
      <td>Seongbuk-gu</td>
      <td>NaN</td>
      <td>contact with patient</td>
      <td>2.0</td>
      <td>1000000002</td>
      <td>2</td>
      <td>NaN</td>
      <td>2020-01-31</td>
      <td>2020-02-24</td>
      <td>NaN</td>
      <td>released</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 컬럼의 자료형을 살펴본다.
df1.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 4004 entries, 0 to 4003
    Data columns (total 18 columns):
     #   Column              Non-Null Count  Dtype  
    ---  ------              --------------  -----  
     0   patient_id          4004 non-null   int64  
     1   global_num          2806 non-null   float64
     2   sex                 3674 non-null   object 
     3   birth_year          3267 non-null   object 
     4   age                 3525 non-null   object 
     5   country             4004 non-null   object 
     6   province            4004 non-null   object 
     7   city                3926 non-null   object 
     8   disease             18 non-null     object 
     9   infection_case      3211 non-null   object 
     10  infection_order     31 non-null     float64
     11  infected_by         899 non-null    object 
     12  contact_number      680 non-null    object 
     13  symptom_onset_date  535 non-null    object 
     14  confirmed_date      4001 non-null   object 
     15  released_date       1508 non-null   object 
     16  deceased_date       65 non-null     object 
     17  state               4004 non-null   object 
    dtypes: float64(2), int64(1), object(15)
    memory usage: 563.2+ KB
    

### 2. 기초적인 탐색.


```python
# 중복된 환자 ID는 없어 보인다.
print("데이터 행의 수 = {}".format(df1.shape[0]))                  # 데이터 행의 수 = 4004
print("고유한 환자 ID 수 = {}".format(df1.patient_id.nunique()))   # 고유한 환자 ID 수 = 4004
```

    데이터 행의 수 = 4004
    고유한 환자 ID 수 = 4004
    


```python
# 결측치의 총 카운트.
df1.isnull().sum().sum()
```




    27910




```python
# 결측치를 시각화 해본다.
plt.figure(figsize = (15,10))                                       # figsize=(가로, 세로) 크기.
sns.heatmap(df1.isnull(), cmap='coolwarm', cbar=True)
plt.show()
```


    
![png](output_11_0.png)
    



```python
df1.age.unique()
```




    array(['50s', '30s', '20s', '60s', '80s', '70s', '40s', '10s', '90s',
           '0s', nan, '30', '100s'], dtype=object)




```python
# 명목형 변수인 Age를 시각화 해본다.
df1.age = df1.age.str.replace('s','',regex=True)                      # 's' 제거.
age_counts = df1.age.value_counts()                                   # 도수표.
age_counts = age_counts.sort_values(ascending=False)
age_counts.plot.bar(color='green', alpha=0.5)
plt.show()
```


    
![png](output_13_0.png)
    



```python
# 명목형 변수인 Sex를 시각화 해본다.
sex_counts = df1.sex.value_counts()              
sex_counts = sex_counts.sort_values(ascending=False)
sex_counts.plot.bar(color='turquoise', alpha=0.7)
plt.show()
```


    
![png](output_14_0.png)
    



```python
# 명목형 변수인 Country를 가지고 내국인 여부를 시각화 해본다.
country_counts = df1.country.value_counts()                 # 내국인 = True.
country_counts = country_counts.sort_values(ascending=False)
country_counts.plot.bar(color='pink', alpha = 0.7)
plt.show()
```


    
![png](output_15_0.png)
    



```python
country_counts = (df1.country == 'Korea').value_counts()                 # 내국인 = True.
country_counts = country_counts.sort_values(ascending=False)
country_counts.index = ['Korean', 'Foreigner']
country_counts.plot.bar(color='pink', alpha = 0.7)
plt.show()
```


    
![png](output_16_0.png)
    



```python
# 명목형 변수인 State를 시각화 해본다.
state_counts = df1.state.value_counts()              
state_counts = state_counts.sort_values(ascending=False)
state_counts.plot.bar(color='blue', alpha=0.5)
plt.show()
```


    
![png](output_17_0.png)
    


### 변수 2개씩 조합해서 분석


```python
# 명목형 변수인 Age와 Sex를 조합하여 시각화 해본다.
ct = pd.crosstab(df1.age, df1.sex)
ct['total'] = ct.male + ct.female                      # total 컬럼.
ct.sort_values(by=['total'], ascending=False)[['male','female']].plot.bar(stacked=True)   # total로 정렬하되 total은 시각화에서는 제외!
plt.show()
```


    
![png](output_19_0.png)
    



```python
# Age별 사망비율.
ct = pd.crosstab(df1.age, df1.state=='deceased')
ct.columns = ['alive','deceased']
# ct.rename(columns = {False : "alive", True : "decreased"}, inplace=True) === 바로 위 코드와 같은 의미임.
ct['mortality'] = ct.deceased/(ct.alive + ct.deceased)
ct.sort_values(by=['mortality'], ascending=False)[['mortality']].plot.bar(color='red', alpha=0.5)   # mortality로 소팅 및 시각화.
plt.show()
```


    
![png](output_20_0.png)
    



```python
# Age와 사망여부 독립성 검정.
stat, p_val, degFree, expected = st.chi2_contingency(ct[['alive','deceased']])    # 통계량, p-값, 자유도, 기대도수.
print("p_value : {}".format(np.round(p_val,3)))                                   # 독립이 아님!
```

    p_value : 0.0
    


```python
# Sex별 사망비율.
ct = pd.crosstab(df1.sex, df1.state=='deceased')
ct.columns = ['alive','deceased']
ct['mortality'] = ct.deceased/(ct.alive + ct.deceased)
ct.sort_values(by=['mortality'], ascending=False)[['mortality']].plot.bar(color='green', alpha=0.5)   # mortality로 소팅 및 시각화.
plt.show()
```


    
![png](output_22_0.png)
    



```python
# Sex와 사망여부 독립성 검정.
stat, p_val, degFree, expected = st.chi2_contingency(ct[['alive','deceased']])    # 통계량, p-값, 자유도, 기대도수.
print("p_value : {}".format(np.round(p_val,3)))                                   # 독립이 아님!
```

    p_value : 0.002
    


```python
# 기저질환 (disease)는 결측치 아닌 정상값의 수가 절대적으로 부족해서 분석하기 어려움.
df1.disease.count()
# 삭제해도 괜찮겠다.
```




    18



### 3. 감염 경로 유형 (Infection Case)


```python
# 감염 경로의 유형 출력.
print(df1.infection_case.unique())
```

    ['overseas inflow' 'contact with patient' 'Seongdong-gu APT' 'etc'
     "Eunpyeong St. Mary's Hospital" 'Shincheonji Church' 'Dongan Church'
     'Guro-gu Call Center' nan 'Itaewon Clubs' 'Samsung Medical Center'
     'Coupang Logistics Center' 'Guri Collective Infection'
     'KB Life Insurance' 'Yeongdeungpo Learning Institute' 'Onchun Church'
     'Cheongdo Daenam Hospital' 'Suyeong-gu Kindergarten'
     'Ministry of Oceans and Fisheries' 'gym facility in Cheonan'
     'gym facility in Sejong' 'River of Grace Community Church'
     'Gyeongsan Seorin Nursing Home' 'Gyeongsan Cham Joeun Community Center'
     'Gyeongsan Jeil Silver Town' 'Bonghwa Pureun Nursing Home'
     'Pilgrimage to Israel' 'Milal Shelter' 'Geochang Church'
     'Changnyeong Coin Karaoke']
    


```python
# 감염 경로의 가지수 출력.
print(df1.infection_case.nunique())
```

    29
    


```python
# 감염 경로별 환자수 집계하여 시각화 한다.
res = df1.groupby(['infection_case'])['patient_id'].count()        # 결측치가 아닌 patient_id의 수 = 환자의 수.
#df1['infection_case'].value_counts()
res = res.reset_index()                                           # Series => DataFrame. 이전의 Index가 이제는 새로운 컬럼!
res.rename(columns = {'infection_case':'infection case', 'patient_id': 'count'}, inplace = True)     # 'patient_id' 컬럼명을 'count'로 변경.
res = res.sort_values(by = 'count', ascending = False)            # 데이터 프레임 내림 차순으로 소팅.
res
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>infection case</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>contact with patient</td>
      <td>1182</td>
    </tr>
    <tr>
      <th>28</th>
      <td>overseas inflow</td>
      <td>703</td>
    </tr>
    <tr>
      <th>25</th>
      <td>etc</td>
      <td>601</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Itaewon Clubs</td>
      <td>156</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Guro-gu Call Center</td>
      <td>112</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Shincheonji Church</td>
      <td>107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Coupang Logistics Center</td>
      <td>70</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Onchun Church</td>
      <td>33</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Bonghwa Pureun Nursing Home</td>
      <td>31</td>
    </tr>
    <tr>
      <th>26</th>
      <td>gym facility in Cheonan</td>
      <td>30</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Ministry of Oceans and Fisheries</td>
      <td>28</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cheongdo Daenam Hospital</td>
      <td>21</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dongan Church</td>
      <td>17</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Eunpyeong St. Mary's Hospital</td>
      <td>16</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Gyeongsan Seorin Nursing Home</td>
      <td>15</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Seongdong-gu APT</td>
      <td>13</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Gyeongsan Jeil Silver Town</td>
      <td>12</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Milal Shelter</td>
      <td>11</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Gyeongsan Cham Joeun Community Center</td>
      <td>10</td>
    </tr>
    <tr>
      <th>13</th>
      <td>KB Life Insurance</td>
      <td>8</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Samsung Medical Center</td>
      <td>7</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Geochang Church</td>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Guri Collective Infection</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Changnyeong Coin Karaoke</td>
      <td>4</td>
    </tr>
    <tr>
      <th>27</th>
      <td>gym facility in Sejong</td>
      <td>4</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Suyeong-gu Kindergarten</td>
      <td>3</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Pilgrimage to Israel</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Yeongdeungpo Learning Institute</td>
      <td>2</td>
    </tr>
    <tr>
      <th>18</th>
      <td>River of Grace Community Church</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 감염 경로별 환자수 집계하여 시각화 한다.
res = df1.groupby(['infection_case'])['patient_id'].count()        # 결측치가 아닌 patient_id의 수 = 환자의 수.
res = res.reset_index()                                           # Series => DataFrame. 이전의 Index가 이제는 새로운 컬럼!
res.rename(columns = {'infection_case':'infection case', 'patient_id': 'count'}, inplace = True)     # 'patient_id' 컬럼명을 'count'로 변경.
res = res.sort_values(by = 'count', ascending = False)            # 데이터 프레임 내림 차순으로 소팅.

plt.figure(figsize = (12,6))                                       # figsize=(가로, 세로) 크기.
sns.barplot(y = 'infection case', x= 'count', data = res)
plt.title('Number of Patients per Infection Case')
plt.show()
```


    
![png](output_29_0.png)
    



```python
my_dict = {'contact with patient':'Individual', 'etc':'Unknown', 'overseas inflow': 'Overseas'}
def my_func(x):
    if not pd.isnull(x):
        if x in my_dict.keys():
            return my_dict[x]
        else:
            return "Group"
    else:
        return "Unknown"
    
res = df1.infection_case.apply(my_func)
df1['infection_cause'] = res
```


```python
# 다음과 같이 유형의 label을 바꾸어서 다시 집계 및 시각화 해본다.
# 'contact with patient' => 'Individual'     개인접촉
# 'etc'  or NaN         => 'Unknown'         모름
# 'overseas inflow'     => 'Overseas'        해외
#  나머지               => 'Group'            집단

my_dict = {'contact with patient':'Individual', 'etc':'Unknown', 'overseas inflow': 'Overseas'}
res = df1.infection_case.apply(lambda x: my_dict[x] if x in my_dict.keys() else 'Group' if not pd.isnull(x) else 'Unknown')  # 변환! Pythonic!
#res = df1.infection_case.apply(my_conversion_func)    # 또다른 방법.
df1['infection_cause'] = res  # 변환을 df1에도 적용.

# 다시 집계하여 시각화 해본다.
res = res.value_counts().sort_values(ascending=False)
res = res.reset_index()                                                               # Series => DataFrame. 이전의 Index가 이제는 새로운 컬럼!
res.rename(columns={'index':'infection_cause','infection_case':'count'},inplace=True)

```


```python
plt.figure(figsize = (12,6))                                       # figsize=(가로, 세로) 크기.
sns.barplot(y = 'infection_cause', x= 'count', data = res, alpha=0.8)
plt.title('Number of Patients per Infection Cause')
plt.show()
```


    
![png](output_32_0.png)
    


**결론**: 유입 경로를 4가지로 요약해 봄.

### 4. 유동성 (Mobility Level)


```python
# 새롭게 유입경로 데이터를 불러온다.
df2 = pd.read_csv(r'.\data\PatientRoute.csv')
```


```python
df2.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>patient_id</th>
      <th>global_num</th>
      <th>date</th>
      <th>province</th>
      <th>city</th>
      <th>type</th>
      <th>latitude</th>
      <th>longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000000001</td>
      <td>2.0</td>
      <td>2020-01-22</td>
      <td>Gyeonggi-do</td>
      <td>Gimpo-si</td>
      <td>airport</td>
      <td>37.6152</td>
      <td>126.7156</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000000001</td>
      <td>2.0</td>
      <td>2020-01-24</td>
      <td>Seoul</td>
      <td>Jung-gu</td>
      <td>hospital</td>
      <td>37.5672</td>
      <td>127.0057</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000000002</td>
      <td>5.0</td>
      <td>2020-01-25</td>
      <td>Seoul</td>
      <td>Seongbuk-gu</td>
      <td>etc</td>
      <td>37.5926</td>
      <td>127.0170</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000000002</td>
      <td>5.0</td>
      <td>2020-01-26</td>
      <td>Seoul</td>
      <td>Seongbuk-gu</td>
      <td>store</td>
      <td>37.5918</td>
      <td>127.0168</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000000002</td>
      <td>5.0</td>
      <td>2020-01-26</td>
      <td>Seoul</td>
      <td>Seongdong-gu</td>
      <td>public_transportation</td>
      <td>37.5640</td>
      <td>127.0295</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 결측치의 총 카운트.
df2.isnull().sum().sum()
```




    3264




```python
# 결측치를 시각화 해본다.
plt.figure(figsize = (10,10))                                       # figsize=(가로, 세로) 크기.
sns.heatmap(df2.isnull(), cmap='Blues', cbar=False)
plt.show()
```


    
![png](output_38_0.png)
    



```python
# 중복된 환자 ID가 많아 보인다.
print("데이터 행의 수 = {}".format(df2.shape[0]))
print("고유한 환자 ID 수 = {}".format(df2.patient_id.nunique()))
```

    데이터 행의 수 = 8092
    고유한 환자 ID 수 = 1472
    


```python
# 이동 경로의 유형 출력.
print(format(df2.type.unique()))
```

    ['airport' 'hospital' 'etc' 'store' 'public_transportation' 'restaurant'
     'church' 'beauty_salon' 'pharmacy' 'pc_cafe' 'bank' 'academy' 'cafe'
     'bakery' 'bar' 'gym' 'school' 'real_estate_agency' 'karaoke'
     'post_office' 'gas_station' 'park' 'lodging' 'university'
     'administrative_area_level_1']
    


```python
# 이동 경로의 가지수 출력.
print(format(df2.type.nunique()))
```

    25
    


```python
# 이동 경로의 유형을 카테고리로 표현해 본다.
leisure = ['library', 'theater', 'cafe', 'bakery', 'beauty_salon',
          'pc_cafe', 'billiards','restaurant', 'bar', 'karaoke']
travel = ['airport', 'lodging']
essential_edu = ['primary_school', 'school', 'university']
non_essential_edu = ['academy']
exercise = ['gym', 'mountain', 'park']
essential_admin = ['administrative_area_level_1', 'governmnet_office', 'post_office']
non_essential_admin = ['police_office', 'bank', 'real_estate_agency']
necessity = ['store', 'public_transportation', 'gas_station']
medical = ['hospital', 'pharmacy']
church = ['church']
etc = ['etc']
```


```python
# "필수적" 카테고리는 다음과 같이 정의한다.
essential = essential_edu + essential_admin + necessity + medical 
len(essential)
```




    11




```python
# 필수/부수적 여부 변수 'is_essential' 파생변수로 추가.
def isessential(x):     
    if x in essential: 
        res = True
    else:
        res = False 
    return res
df2['is_essential'] = df2['type'].apply(lambda x: isessential(x)) 

# 데이터 프레임 간추리기.
df2 = df2[['patient_id', 'type', 'is_essential']]
df2.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>patient_id</th>
      <th>type</th>
      <th>is_essential</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000000001</td>
      <td>airport</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000000001</td>
      <td>hospital</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000000002</td>
      <td>etc</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000000002</td>
      <td>store</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000000002</td>
      <td>public_transportation</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 동일 환자의 경로 유형을 집계한다 (sum).
# 결측치는 0으로 채운다.
df2['route_value'] = 1       # 1 로 채워진 컬럼을 추가해서 집계의 목적으로 사용한다.
df3 = pd.pivot_table(data=df2, index = 'patient_id', columns = 'is_essential', values= 'route_value', aggfunc='sum', fill_value=0)
df3.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>is_essential</th>
      <th>False</th>
      <th>True</th>
    </tr>
    <tr>
      <th>patient_id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1000000001</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1000000002</th>
      <td>4</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1000000003</th>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1000000004</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1000000005</th>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Index로 있는 patient_id를 컬럼으로 빼내고 정리한다.
df3.columns.name=None
df3 = df3.reset_index()
df3 = df3.rename(columns={False:'non_essential',True:'essential'})
df3.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>patient_id</th>
      <th>non_essential</th>
      <th>essential</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000000001</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000000002</td>
      <td>4</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000000003</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000000004</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000000005</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
# df1 (PatientInfo)와 df3 (PatientRoute 요약)을 Inner Join 해서 가로 방향으로 붙여서 df_joined를 만든다.
df_joined = df1.merge(df3, left_on = 'patient_id', right_on = 'patient_id' , how='inner')
```


```python
# 살펴본다.
df_joined.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>patient_id</th>
      <th>global_num</th>
      <th>sex</th>
      <th>birth_year</th>
      <th>age</th>
      <th>country</th>
      <th>province</th>
      <th>city</th>
      <th>disease</th>
      <th>infection_case</th>
      <th>...</th>
      <th>infected_by</th>
      <th>contact_number</th>
      <th>symptom_onset_date</th>
      <th>confirmed_date</th>
      <th>released_date</th>
      <th>deceased_date</th>
      <th>state</th>
      <th>infection_cause</th>
      <th>non_essential</th>
      <th>essential</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000000001</td>
      <td>2.0</td>
      <td>male</td>
      <td>1964</td>
      <td>50</td>
      <td>Korea</td>
      <td>Seoul</td>
      <td>Gangseo-gu</td>
      <td>NaN</td>
      <td>overseas inflow</td>
      <td>...</td>
      <td>NaN</td>
      <td>75</td>
      <td>2020-01-22</td>
      <td>2020-01-23</td>
      <td>2020-02-05</td>
      <td>NaN</td>
      <td>released</td>
      <td>Overseas</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000000002</td>
      <td>5.0</td>
      <td>male</td>
      <td>1987</td>
      <td>30</td>
      <td>Korea</td>
      <td>Seoul</td>
      <td>Jungnang-gu</td>
      <td>NaN</td>
      <td>overseas inflow</td>
      <td>...</td>
      <td>NaN</td>
      <td>31</td>
      <td>NaN</td>
      <td>2020-01-30</td>
      <td>2020-03-02</td>
      <td>NaN</td>
      <td>released</td>
      <td>Overseas</td>
      <td>4</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000000003</td>
      <td>6.0</td>
      <td>male</td>
      <td>1964</td>
      <td>50</td>
      <td>Korea</td>
      <td>Seoul</td>
      <td>Jongno-gu</td>
      <td>NaN</td>
      <td>contact with patient</td>
      <td>...</td>
      <td>2002000001</td>
      <td>17</td>
      <td>NaN</td>
      <td>2020-01-30</td>
      <td>2020-02-19</td>
      <td>NaN</td>
      <td>released</td>
      <td>Individual</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000000004</td>
      <td>7.0</td>
      <td>male</td>
      <td>1991</td>
      <td>20</td>
      <td>Korea</td>
      <td>Seoul</td>
      <td>Mapo-gu</td>
      <td>NaN</td>
      <td>overseas inflow</td>
      <td>...</td>
      <td>NaN</td>
      <td>9</td>
      <td>2020-01-26</td>
      <td>2020-01-30</td>
      <td>2020-02-15</td>
      <td>NaN</td>
      <td>released</td>
      <td>Overseas</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000000005</td>
      <td>9.0</td>
      <td>female</td>
      <td>1992</td>
      <td>20</td>
      <td>Korea</td>
      <td>Seoul</td>
      <td>Seongbuk-gu</td>
      <td>NaN</td>
      <td>contact with patient</td>
      <td>...</td>
      <td>1000000002</td>
      <td>2</td>
      <td>NaN</td>
      <td>2020-01-31</td>
      <td>2020-02-24</td>
      <td>NaN</td>
      <td>released</td>
      <td>Individual</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>




```python
# 모든 환자에 대해서 동선이 명확한 것이 아니기 때문에 Join 후 대폭 행의 수가 줄어 들었다.
print("Number of Rows Before = {}".format(len(df1)))
print("Number of Rows After = {}".format(len(df_joined)))
```

    Number of Rows Before = 4004
    Number of Rows After = 1472
    

### 5. 접촉 빈도 (Number of Contacts)


```python
# contact_number가 결측치가 아니고 '-'가 아닌 행들만 가져온다. '-'는 오류로 유입된 값인듯.
res = df_joined.contact_number
df_joined = df_joined[~res.isnull() & (res != '-')]
```


```python
# contact_number의 자료형을 integer로 변경하고 이상값은 제거한다.
df_joined['contact_number'] = df_joined.contact_number.astype(int)
df_joined = df_joined[df_joined.contact_number < 10000]
```


```python
# 최대 첩촉빈도.
df_joined.contact_number.max()
```




    1160




```python
# 최대 첩촉빈도에 해당하는 환자.
df_joined[df_joined.contact_number == df_joined.contact_number.max()]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>patient_id</th>
      <th>global_num</th>
      <th>sex</th>
      <th>birth_year</th>
      <th>age</th>
      <th>country</th>
      <th>province</th>
      <th>city</th>
      <th>disease</th>
      <th>infection_case</th>
      <th>...</th>
      <th>infected_by</th>
      <th>contact_number</th>
      <th>symptom_onset_date</th>
      <th>confirmed_date</th>
      <th>released_date</th>
      <th>deceased_date</th>
      <th>state</th>
      <th>infection_cause</th>
      <th>non_essential</th>
      <th>essential</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>901</th>
      <td>1200000031</td>
      <td>31.0</td>
      <td>female</td>
      <td>1959</td>
      <td>60</td>
      <td>Korea</td>
      <td>Daegu</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Shincheonji Church</td>
      <td>...</td>
      <td>NaN</td>
      <td>1160</td>
      <td>NaN</td>
      <td>2020-02-18</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>isolated</td>
      <td>Group</td>
      <td>5</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 21 columns</p>
</div>




```python
# 필요한 컬럼만 가져와서 정리한다.
df4 = df_joined[['patient_id', 'contact_number', 'essential','non_essential','infection_cause']]
df4.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>patient_id</th>
      <th>contact_number</th>
      <th>essential</th>
      <th>non_essential</th>
      <th>infection_cause</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000000001</td>
      <td>75</td>
      <td>1</td>
      <td>1</td>
      <td>Overseas</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000000002</td>
      <td>31</td>
      <td>9</td>
      <td>4</td>
      <td>Overseas</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000000003</td>
      <td>17</td>
      <td>0</td>
      <td>2</td>
      <td>Individual</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000000004</td>
      <td>9</td>
      <td>1</td>
      <td>0</td>
      <td>Overseas</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000000005</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>Individual</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 접촉 빈도를 히스토그램으로 시각화 한다.
sns.distplot(df4.contact_number,bins=50)
plt.show()
```


    
![png](output_56_0.png)
    


### 6. 군집화 (Clustering)


```python
# Infection_cause를 가변수 처리한다.
df4 = df4.join(pd.get_dummies(df4.infection_cause, prefix='infection',drop_first=False))
```


```python
df4
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>patient_id</th>
      <th>contact_number</th>
      <th>essential</th>
      <th>non_essential</th>
      <th>infection_cause</th>
      <th>infection_Group</th>
      <th>infection_Individual</th>
      <th>infection_Overseas</th>
      <th>infection_Unknown</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000000001</td>
      <td>75</td>
      <td>1</td>
      <td>1</td>
      <td>Overseas</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000000002</td>
      <td>31</td>
      <td>9</td>
      <td>4</td>
      <td>Overseas</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000000003</td>
      <td>17</td>
      <td>0</td>
      <td>2</td>
      <td>Individual</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000000004</td>
      <td>9</td>
      <td>1</td>
      <td>0</td>
      <td>Overseas</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000000005</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>Individual</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1242</th>
      <td>6001000045</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>Unknown</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1244</th>
      <td>6001000061</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>Unknown</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1246</th>
      <td>6001000063</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>Unknown</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1317</th>
      <td>6014000001</td>
      <td>11</td>
      <td>1</td>
      <td>4</td>
      <td>Unknown</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1318</th>
      <td>6014000002</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>Unknown</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>366 rows × 9 columns</p>
</div>




```python
df_final = df4[ ['essential', 'non_essential', 'contact_number',
          'infection_Group', 'infection_Individual', 'infection_Overseas', 'infection_Unknown']]
```


```python
df_final
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>essential</th>
      <th>non_essential</th>
      <th>contact_number</th>
      <th>infection_Group</th>
      <th>infection_Individual</th>
      <th>infection_Overseas</th>
      <th>infection_Unknown</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>75</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9</td>
      <td>4</td>
      <td>31</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>2</td>
      <td>17</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>9</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1242</th>
      <td>4</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1244</th>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1246</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1317</th>
      <td>1</td>
      <td>4</td>
      <td>11</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1318</th>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>366 rows × 7 columns</p>
</div>




```python
# 컬럼의 표준화를 실행한다.
X = df_final.values                        
my_scaler = StandardScaler()
X = my_scaler.fit_transform(X)
```


```python
# 군집의 수 = 4로 정하고 군집화를 실행한다.  <= 군집의 수 최적화가 선행되어야 한다! (부록 참고)
my_km = KMeans(n_clusters = 4, random_state = 123)
my_km.fit(X)

my_centroids = my_km.cluster_centers_               # 개개 군집의 중심점.
my_cluster_labels = my_km.labels_                   # 군집 label.
```


```python
# 클러스터 중심을 출력하고 해석한다.
pd.DataFrame(my_centroids,columns = df_final.columns)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>essential</th>
      <th>non_essential</th>
      <th>contact_number</th>
      <th>infection_Group</th>
      <th>infection_Individual</th>
      <th>infection_Overseas</th>
      <th>infection_Unknown</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.0707</td>
      <td>0.0216</td>
      <td>-0.0293</td>
      <td>-0.5458</td>
      <td>-0.7916</td>
      <td>-0.4820</td>
      <td>2.0207</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.0115</td>
      <td>-0.0777</td>
      <td>-0.1040</td>
      <td>-0.5458</td>
      <td>1.2632</td>
      <td>-0.4820</td>
      <td>-0.4949</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.1589</td>
      <td>-0.2342</td>
      <td>-0.0300</td>
      <td>-0.5458</td>
      <td>-0.7916</td>
      <td>2.0747</td>
      <td>-0.4949</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.2104</td>
      <td>0.3043</td>
      <td>0.2243</td>
      <td>1.8323</td>
      <td>-0.7916</td>
      <td>-0.4820</td>
      <td>-0.4949</td>
    </tr>
  </tbody>
</table>
</div>



**해석:** <br>
- Label 0 (red): Social minimalists.
- Label 1 (blue): Hyper-mobile and hyper-social.
- Label 2 (green): Overseas non-essentialists. 
- Label 3 (yellow): Moderate unknwons.


```python
# PCA 차원축소 (2차원).
my_pca = PCA(n_components = 2)
transformed_comps = my_pca.fit_transform(X)         # Transformed 된 좌표.
df_transformed_comps = pd.DataFrame(data = transformed_comps, columns = ['PC1', 'PC2'])
df_transformed_comps=df_transformed_comps.join(pd.Series(my_cluster_labels, name='cluster_label'))
df_transformed_comps
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PC1</th>
      <th>PC2</th>
      <th>cluster_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.6870</td>
      <td>-1.5806</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.8155</td>
      <td>-0.7954</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.3612</td>
      <td>1.0461</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.0707</td>
      <td>-1.6690</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.4295</td>
      <td>1.0558</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>361</th>
      <td>-0.1423</td>
      <td>-1.1056</td>
      <td>0</td>
    </tr>
    <tr>
      <th>362</th>
      <td>-0.4166</td>
      <td>-1.2754</td>
      <td>0</td>
    </tr>
    <tr>
      <th>363</th>
      <td>-0.6912</td>
      <td>-1.3779</td>
      <td>0</td>
    </tr>
    <tr>
      <th>364</th>
      <td>-0.2865</td>
      <td>-1.2340</td>
      <td>0</td>
    </tr>
    <tr>
      <th>365</th>
      <td>-0.4138</td>
      <td>-1.2524</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>366 rows × 3 columns</p>
</div>




```python
# 산점도 시각화.
my_colors = {0:'red',1:'blue',2:'green',3:'yellow'}    # 군집 label => Color.
my_names = {0: 'Social minimalists.', 1: 'Hyper-mobile and hyper-social.' , 2: 'Overseas non-essentialists.', 3: 'Moderate unknwons.'} # 군집 label => 명칭.

plt.figure(figsize = (6,6))
for a_cluster_n, df_small in df_transformed_comps.groupby('cluster_label'):
    plt.scatter('PC1', 'PC2', data = df_small, c = my_colors[a_cluster_n], label = my_names[a_cluster_n], s = 10, alpha=0.6 )
plt.xlabel('PC1')
plt.ylabel('PC2')
plt.title('Clusters')
plt.legend(loc=4)
plt.show()
```


    
![png](output_67_0.png)
    


### 부록: 군집의 수 최적화


```python
# 군집의 수를 키워가며 Sum of Squares Within을 계산한다.
ssw = []
cluster_ns = range(2,16)
for n in cluster_ns:
    my_cluster = KMeans(n)
    my_cluster.fit(X)
    ssw += [my_cluster.inertia_]         # SSW를 모아둔다.

plt.figure(figsize = (6,6))
plt.plot(cluster_ns, ssw)
plt.title('Elbow Method')
plt.xlabel('Number of Clusters')
plt.ylabel('Sum of Squares Within')
plt.show()
```


    
![png](output_69_0.png)
    


**결론**: 군집의 수가 5 이상일 때 SSW의 감소 속도가 둔화된다. => 군집의 적정 수 = 4.
