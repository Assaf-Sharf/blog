---
layout: post
title:  "Spark Partitioning 자원관리에 대한 고찰"
---

# 파티셔닝을 하는 이유는?

**파티셔닝이란 무엇인가요?**

스파크 파티셔닝은 Apache Spark라는 분산 데이터 처리 프레임워크에서 사용되는 중요한 개념입니다. 
스파크는 대량의 데이터를 효율적으로 처리하기 위한 기능을 제공하며, 이를 위해 데이터를 파티션으로 나누어 분산 처리하는 방식을 채택하고 있습니다.

스파크 파티셔닝은 데이터를 논리적 또는 물리적인 단위로 나누는 과정을 의미합니다. 
이렇게 분할된 데이터는 여러 개의 노드에 분산되어 병렬로 처리될 수 있습니다. 
스파크의 파티셔닝은 데이터를 효율적으로 분산 저장하고 처리할 수 있도록 도와줍니다.

스파크에서는 주로 두 가지 유형의 파티셔닝을 사용합니다. 
1. 첫 번째는 해시 파티셔닝(Hash Partitioning)이며, 데이터의 특정 열 값을 해싱하여 파티션을 할당합니다. 
해시 파티셔닝은 동일한 키 값이 동일한 파티션에 할당되도록 보장하므로, 동일한 키 값을 가진 데이터는 동일한 파티션에서 처리됩니다. 
이를 통해 조인 연산과 같은 작업에서 데이터의 이동이 최소화되어 성능을 향상시킬 수 있습니다.

2. 두 번째는 범위 파티셔닝(Range Partitioning)입니다. 이 방식은 데이터의 특정 열 값을 기준으로 범위를 나누어 파티션을 할당합니다. 
예를 들어, 날짜 열을 기준으로 범위를 나눈다면 각 파티션은 특정 기간의 데이터를 포함하게 됩니다. 
범위 파티셔닝은 데이터의 정렬이나 범위 기반의 질의에 유리하며, 일부 작업에서는 해시 파티셔닝보다 성능이 우수할 수 있습니다.

3. 세번째는 리스트 파티셔닝 입니다. 

스파크에서는 사용자가 직접 파티셔닝 방식을 선택하거나, 데이터의 크기와 특성에 따라 자동으로 파티셔닝을 결정할 수 있는 기능을 제공합니다. 
또한, 파티셔닝은 데이터의 물리적 배치를 제어하는 데 사용되며, 데이터의 로드 및 저장, 셔플 작업 등에서 중요한 역할을 합니다.
스파크 파티셔닝을 효과적으로 활용하면 데이터 처리 작업의 성능을 향상시킬 수 있습니다.

**효과적인 파티셔닝?**
파티셔닝을 결정짓는 요소들은 master, executor 이다.

파티션 개수가 너무 많은 경우
장점
단점

파티션 개수가 너무 적은 경우
장점
단점

*빅데이터를 다루는 경우, 실무하는 도중 자원관리를 실패하여 OOM에러가 나는 현상을 자주 볼수 있습니다. 
경험으로 효율적인 파티셔닝을 찾아가는 방법이 있습니다.


**아직 만드는중**

참고자료
https://tech.kakao.com/2021/10/08/spark-shuffle-partition/
https://jaemunbro.medium.com/apache-spark-partition-%EA%B0%9C%EC%88%98%EC%99%80-%ED%81%AC%EA%B8%B0-%EC%A0%95%ED%95%98%EA%B8%B0-3a790bd4675d
https://jaemunbro.medium.com/spark-executor-%EA%B0%9C%EC%88%98-%EC%A0%95%ED%95%98%EA%B8%B0-b9f0e0cc1fd8
https://m.blog.naver.com/syung1104/221103154997

