---
title:  "[ML] 데이터 분석에 로그변환이 필요한 이유"
layout: single

categories: ["ML", "TIL"]
tags: 
    - "머신러닝"
    - "정규분포"

toc: true
toc_sticky: true
toc_label : "목차"
published: false
---

<br>

# 로그(Logarithm)
- 로그는 지수함수의 역함수입니다.
- 어떤 수를 나타내기위해 고정된 밑을 몇 번 곱하여야 하는지를 나타냅니다.
  - 이 성질을 이용하면 이상치가 있는 데이터를 정규분포와 비슷한 형태로 만들 수 있습니다.

<br>

<div style="text-align : center;">
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Logarithm_plots.png/600px-Logarithm_plots.png" width="400" >
</div>
<center><small>Fig 1. 일반적으로 사용되는 세 가지 밑이 있는 로그 함수 플롯</small></center>

<br>

## 로그 함수 특징
로그 함수의 특징은 다음과 같습니다.

- 밑이 더 작은 값에 기울기가 가파르고 값이 커질수록 기울기가 완만해 집니다.
  - 밑이 작은 로그 함수는 밑이 큰 로그 함수보다 ```x``` 값들에 대해서 ```y``` 값의 차이가 큽니다.

<br>

- ```0 < x < 1``` 범위에서는 기울기가 매우 가파릅니다.
  - ```x``` 가 0 ~ 1 사이의 값을 가지면 ```y```는 0부터 -∞ 사이의 값을 가집니다.

<br>

- ```x``` 값이 점점 커짐에 따라 로그함수의 기울기는 급격히 작아집니다.
  - ```x``` 에 큰 값이 들어가도 ```y``` 값이 크게 차이나지 않습니다.
  - 즉, 넓은 범위를 가지는 ```x```를 비교적 작은 ```y``` 값 구간 내에 모이게 합니다.


## 로그 함수 이해하기
- 로그(Logarithm)를 사용하면, 매우 작은 값과 매우 큰값 등을 포함하는 광범위한 범위를 작은 범위로 줄일 수 있습니다.
- 예시로 이해해 봅시다.

```python
import pandas as pd
import numpy as np

# pH 농도는 -log([H+])로 계산됩니다.
# 수소 이온 농도를 데이터프레임으로 생성합니다.
data = {"[H+]": [5.8e-3, 6.0e-12, 3.0e-2, 1.2e-10, 3.2e-4, 4.1e-6, 9.3e-8]}
# 데이터 프레임으로 변환
df = pd.DataFrame(data)
# pH 파생변수 생성 
df["pH"] = round(-np.log(df["[H+]"])/np.log(10), 2)
df
```

||[H+]|	pH|
|:---|:---|:---|
|0|	5.800000e-03|	2.24|
|1|	6.000000e-12|	11.22|
|2|	3.000000e-02|	1.52|
|3|	1.200000e-10|	9.92|
|4|	3.200000e-04|	3.49|
|5|	4.100000e-06|	5.39|
|6|	9.300000e-08|	7.03|

<br>

```python
# 서브 플롯을 그려 로그변환 전, 후 비교하기
fig, axes = plt.subplots(nrows=1, ncols=2, figsize=(12, 3))
sns.barplot(x=df.index, y=df["[H+]"], ax=axes[0]).set_title("용액별 수소이온 농도")
sns.barplot(x=df.index, y=df.pH, ax=axes[1]).set_title("용액별 pH");
```

<div style="text-align : center;">
<img src="https://ifh.cc/g/vKbh65.png">
</div>
<center><small>Fig 2. 로그변환 전(왼쪽), 후(오른쪽) 그래프</small></center>

<br>

# 로그변환
데이터 분석에서 로그를 취하는 이유는 <u>정규성을 높이고 분석에서 정확한 값을 얻기 위함이다.</u><br>
데이터 간 편차를 줄여 왜도(skewness)와 첨도(Kurtosis)를 줄일 수 있기 때문에 정규성을 높일 수 있다.

## 로그변환 실습
- 사용한 데이터 : Kaggle 


<br>

# Reference
- [위키백과, 우리 모두의 백과사전 - Logarithm](https://en.wikipedia.org/wiki/Logarithm)
- [위키백과, 우리 모두의 백과사전 - 정규분포](https://ko.wikipedia.org/wiki/%EC%A0%95%EA%B7%9C_%EB%B6%84%ED%8F%AC)
- [티스토리 by 프로도의 블로그 - 데이터 분석 시 식에 로그를 취하는 이유](https://leebaro.tistory.com/entry/%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EC%84%9D-%EC%8B%9C-%EC%8B%9D%EC%97%90-%EB%A1%9C%EA%B7%B8%EB%A5%BC-%EC%B7%A8%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0)

<br>