# 운영체제 개요

> 운영체제의 필요한 개념들의 요약을 정리함
>
> ** 혹시 틀린 내용이나 부족한 내용이 있으면 댓글로 지적해주시면 큰 도임이 됩니다.

### 운영체제란

* 실행할 프로그램에 필요한 자원을 할당하는 역할
  * **자원** : CPU, 메모리, 입출력장치, 보조기억장치
* 프로그램이 올바르게 실행되도록 돕는 특별한 프로그램

* 메모리 내 커널 영역(Kernel space)에 적재되어있음

  -> 커널 영역을 제외한 나머지 영역, 사용자가 이용하는 영역 : 사용자 영역

* 운영 체제는 관리할 자원별로 기능이 나누어져 있음

(메모리 영역 그림 - 커널 영역, 사용자 영역 / 운영체제 자원별 기능 나눠진 그림)

(그림)

### 커널

(커널 그림)

* 운영체제는 굉장히 큰 프로그램이고, 수많은 기능들을 지원한다.

* 하지만, 이 중 가장 중요한 기능은 다음과 같다.

  1. 자원에 접근하고 조작하는 기능
  2. 프로그램이 올바르고 안전하게 실행되게 하는 기능

  => 이러한 운영체제의 핵심 서비스를 담당하는 부분을 커널(Kernel)이라고 한다.

* cf) 그렇다면, 운영체제가 제공하는 기능 중, 커널에 포함되지 않는 서비스는 무엇일까.
  * 사용자 인터페이스(UI: User Interface) : 사용자와 상호작용할 수 있는 통로
    1. GUI : Graphic User Interface
    2. CLI : Command Line Interface



### 이중 모드와 시스템 호출

* 만약 운영체제가 없다면?

  * 수많은 응용 프로그램이 직접 CPU, 메모리, 하드 디스크 자원에 접근하고 조작할 것이다. -> *무질서하게 관리될 것!*
  * 응용 프로그램이 조금이라도 문제가 생기면 컴퓨터 전체(H/W)에도 큰 영향을 끼칠 것이다.

  => 따라서, 운영체제는 응용 프로그램들이 자원에 접근하려고 할 때, 오직 자신을 통해서만 접근하도록 하여 자원을 보호한다.

  => H/W 자원에 접근하기 위해서는 응용 프로그램들은 운영체제에 도움을 요청(운영체제 코드를 실행)해야 한다. (운영체제가 "대신" 필요한 자원 관련 코드를 수행)

* cf) CPU가 사용자 모드, 혹은 커널 모드로 실행 중인지는 플래그 레지스터 속 슈퍼바이저 플래그를 보면 알 수 있음.

​	(하드디스크 저장 대신 해주는 그림)

> 위와 같은 '문지기의' 기능은 이중모드(Dual Mode)로부터 구현된다.

#### 이중모드

* CPU가 명령어를 실행하는 모드를 크게, 사용자 모드와 커널 모드로 구분하는 방식
* **사용자 모드** : 운영체제 서비스를 제공받을 수 없는 상태
  * 일반적인 응용 프로그램은 기본적으로 사용자 모드로 실행
  * 자원에 접근이 불가능하다.
* **커널 모드** : 운영체제 서비스를 제공받을 수 있는 상태 -> 커널 영역 코드 실행O
  * 자원에 접근이 가능하다.

#### 시스템 호출(System Call) 

사용자 모드로 실행되는 프로그램이 자원에 접근하는 운영체제 서비스를 제공받고자 커널 모드로의 전환을 요청하는 것.

* 시스템 콜은 소프트웨어 인터럽트의 일종이다.
  * 인터럽트 : 입출력장치에 의한 HW 인터럽트, 명령어에 의한 SW 인터럽트
* 시스템 호출 과정
  1. 시스템 호출을 발생시키는 명령어가 실행
  2. CPU는 지금까지의 작업을 백업
  3. 커널 영역 내에 시스템 호출을 수행하는 코드(인터럽트 서비스 루틴)을 실행
  4. 다시 기존의 응용프로그램으로 복귀

(시스템 콜 그림)

(시스템 콜 그림2)



### 운영체제의 핵심 서비스

#### 1. 프로세스 관리

* **프로세스(Process)** : 실행 중인 프로그램

* 일반적으로, 하나의 CPU는 한 번에 하나의 프로세스만 실행 가능하다.

  => 따라서 여러 프로세스가 CPU를 번갈아 가면서 사용한다.

* 이러한 프로세스는 상태, 사용하고자 하는 자원이 다양하다.

  => 다양한 프로세스를 운영체제가 일목요연하게 관리해야한다.

* cf) 여러 프로세스가 동시에 실행되는 환경에서는 **'프로세스 동기화'**가 필수
* cf) 프로세스가 꼼짝도 못하고 더 이상 실행되지 못하는 **'교착 상태'**를 해결해야 한다.

#### 2. 자원 접근 및 할당

**CPU**

* 메모리에는 여러 프로세스가 적재되고, CPU는 한 번에 하나의 프로세스만 수행한다.
* 프로세스들에게 공평하게 CPU를 할당하기 위해서 어떤 프로세스부터 할 것인지, 얼마나 할당할 것인지를 결정할 수 있어야함 => **CPU 스케줄링**

**메모리**

* 메모리에 적재되는 프로세스들은 크기도, 적재되는 주소도 가지각색
* 같은 프로세스 더라도 적재되는 주소가 달라질 수 있음
* 운영체제는 "어떻게" 프로세스를 저장할지, "어디에(어느 주소에)" 프로세스를 저장할지, 그리고 메모리가 부족하면 이를 어떻게 극복할지를 결정한다.

**입출력장치**

* 인터럽트 서비스 루틴은 운영체제가 제공하는 기능으로, 커널 영역에 있음
* 하드웨어 인터럽트도 마찬가지다.
* 이처럼, 입출력 장치로부터 CPU에 인터럽트 요청 신호를 보내면, CPU는 하던 일을 잠시 백업하고 인터럽트 서비스 루틴을 실행한다.
* 운영체제는 이러한, 인터럽트 서비스를 수행하는 프로그램(인터럽트 서비스 루틴)을 제공하여 입출력 작업을 수행함

#### 3. 파일 시스템 관리

* 사용자는 파일을 열고(Read), 생성하고(Create), 수정(Update), 삭제(Delete)
* 그리고 이 파일들을 디렉토리(파일)로 관리함
* 이러한 **파일 시스템**도 운영체제의 핵심 서비스이다.



### 정리

* 운영체제는 핵심 서비스를 제공하는 커널(Kernel)이 있음
* 사용자 프로세스가 핵심 서비스를 이용하기 위해서는 시스템 콜을 통해서 사용자 모드에서 커널 모드로 CPU 모드를 전환해야함
* 이러한 핵심 서비스에는 아래 3가지가 있음
  1. 프로세스 관리
  2. 자원 접근 및 할당(CPU, 메모리, 입출력 장치)
  3. 파일 시스템 관리



### 추가 내용 : 가상 머신, 

### 궁금한점

* 출력장치인 모니터도 결국 자원아닌가?
* 그러면 CLI, GUI와 같은 인터페이스도 결국 커널 기능으로 보는게 맞지않을까 싶은데...

### Reference

* 혼자 공부하는 컴퓨터구조 + 운영체제 - 강민철 저