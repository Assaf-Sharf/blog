---
layout: single
title:  "목록형 매개 변수(2)"
categories: Tableau
tag: [Tableau]
toc: true
---

## 목록형 매개 변수

우리가 숫자 레이블의 단위를 변경할 때 주로 이용하는 방식은 서식을 변경하는 것이다. 그런데 서식을 변경하지 않고도 매개 변수의 값에 따라서 숫자의 단위를 변경할 수도 있다. 매개 변수의 목록 형태로 숫자의 단위를 임의로 설정하고, 그 단위에 연결되는 계산식을 만든 다음에 테이블 안에서 숫자의 단위를 동적으로 변환하는 것이다.

## (1) 매개변수 설정하기

차원에 있는 [고객 세그먼트],[제품 대분류],[주문 일자],[지역],[매출]필드를 Crtl키를 누른 상태에서 <표현 방식>에 있는 '텍스트 테이블'을 선택해준다.

![image](https://user-images.githubusercontent.com/100071667/226232205-f89abce0-89a5-4a28-95f9-0ff6dfff482f.png)

마우스로 더블 클릭하거나 드래그 앤 드롭으로 데이터를 시각화 했는데 복수 개를 선택한 다음에 표현 방식에 있는 차트를 선택하면 뷰에 바로 표현된다.

<br>

단위를 변경 할 수 있는 매개 변수를 아래와 같이 만들어준다. 

![image](https://user-images.githubusercontent.com/100071667/226232671-9522e93f-8e05-47c3-bfc6-23197aa97b2e.png)

좌측 사이드 바에서 '계산된 필드 만들기'를 통해 아래와 같은 계산식을 만들어준다.

![image](https://user-images.githubusercontent.com/100071667/226232969-9ed722ed-22d9-4680-b050-0649c3961f27.png)

테이블 안의 제주 지역은 매출이 없는 경우가 있는데 값이 없는 경우에 빈 셀로 나오는 것이 아니라 숫자 0이 나오도록 하기 위해 측정값에 있는 [C_매출 단위 변경]필드를 복제하여 아래와 같은 계산식을 만들어준다.

![image](https://user-images.githubusercontent.com/100071667/226233236-aa1fb23a-797d-4313-a546-fe5ec70620e5.png)

위 계산식에 대해 설명

1. SUM([매출])/[p_단위 변경]계산식으로 매개 변수인 [p_단위 변경]값에 따라 매출 합계가 해당 단위로 변경된다.

2. 그렇지만 제주 지역은 매출이 없어서 빈 셀들이 나오니,**LOOKUP함수**를 써서 현재 위치에 있는 값을 그대로 불러온다. 그 계산식이 LOOKUP(SUM([매출]/[p_단위 변경],0))이다. LOOKUP에서 계산식을 먼저 쓰고 콤마 뒤에 오프셋을 쓰는데 여기에 0을 넣으면 현재 값을 그대로 불러온다.

3. 값이 있는 셀들을 그대로 불러오고 빈 값들도 여전히 빈 값으로 불러오는데, 빈 값은 0으로 치환해주기 위해 ZN함수를 맨 앞에 쓰게 된다. **ZN**이란, Zeor Null로 null값을 0으로 치환해주는 함수이다.

<br>

[c_매출 단위 변경_ZN]필드를 테이블에 반영해주면 제주 지역의 빈 셀들이 0으로 바뀌고 나머지는 그대로인 것을 볼 수 있다.

![image](https://user-images.githubusercontent.com/100071667/226233829-fd9b26c6-69db-496b-9bd5-fb5558a2a169.png)

다른 사람들에게 테이블 안에 있는 숫자의 단위를 명확하게 표시해주기 위해 워크시트의 제목을 아래와 같이 편집해준다.

![image](https://user-images.githubusercontent.com/100071667/226234085-a2f1b32a-d169-45d8-b730-92cdc03d87b9.png)

매개 변수에 따라 테이블내 숫자의 단위도 바뀌면서 워크 시트 제목의 단위도 변경되는 것을 볼 수 있다.

![image](https://user-images.githubusercontent.com/100071667/226234223-d4299403-b2e5-4f76-99b0-de9c24e66264.png)