---
title:  "[Oracle DB] JDBC CRUD(3)"

categories:
  - oracleDB
tags:
  - [RDBMS,OracleDB,JDBC,JAVA]

toc: true
toc_sticky: true

date: 2021-09-07
last_modified_at: 2021-09-07

---

# Oracle DB- JDBC CRUD(3)
개인적으로 공부하면서 참조하려고 만든 포스트입니다.
유튜브 뉴렉처 님의 강의를 참고하였습니다.


**폴더구조**
<br>
![image](https://user-images.githubusercontent.com/69495129/132339334-b9549691-a415-45b1-bc38-c165d48dc55e.png)
<br>

## CRUD 를 담당하는 서비스 클래스 생성하기
4개의 기능을 담고있다. getList로 List<Notice> 를 반환한다. 
컬럼들을 담을 수 있는 개념적인 그릇 Notice 객체를 만들어준다
그릇은 entity 라고 한후 Notice 라는 객체를 만들어준다 db 의 Column 에 들어가는 속성들을 Notice는 갖고있어야한다.

``` java
package com.chanhyuk.app.entity;

import java.util.Date;

public class Notice {

    private int id;
    private String title;
    private String writerId;
    private Date regDate;
    private String content;
    private int hit;

    public int getId() {
        return id;
    }

    public String getTitle() {
        return title;
    }

    public String getWriterId() {
        return writerId;
    }

    public Date getRegDate() {
        return regDate;
    }

    public String getContent() {
        return content;
    }

    public int getHit() {
        return hit;
    }

    public void setId(int id) {
        this.id = id;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public void setWriterId(String writerId) {
        this.writerId = writerId;
    }

    public void setRegDate(Date regDate) {
        this.regDate = regDate;
    }

    public void setContent(String content) {
        this.content = content;
    }

    public void setHit(int hit) {
        this.hit = hit;
    }

    public Notice(int id, String title, String writerId, Date regDate, String content, int hit) {
        this.id = id;
        this.title = title;
        this.writerId = writerId;
        this.regDate = regDate;
        this.content = content;
        this.hit = hit;
    }

    public Notice(){

    }
}
  
```
  
아래는 네가지 CRUD 기능을 가진 NoticeService.java 이다.
  
``` java
package com.chanhyuk.app.service;

import com.chanhyuk.app.entity.Notice;

import java.sql.*;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

public class NoticeService {
    private String url = "jdbc:oracle:thin:@localhost:1521/xepdb1";
    private String uid = "yourId";
    private String pwd = "yourPassword";
    private String driver = "oracle.jdbc.driver.OracleDriver";

    public List<Notice> getList(int page, String field, String query) throws ClassNotFoundException, SQLException {

        int start = 1 + (page - 1) * 10;      // 1 , 11 , 21 , 31, 수열 등차수열
        int end = 10 * page;  // 10,20,30,40


        String sql = "SELECT * FROM NOTICE_VIEW WHERE "+ field +" LIKE ? AND NUM BETWEEN ? AND ?";

        Class.forName(driver);
        Connection con = DriverManager.getConnection(url, uid, pwd);
        PreparedStatement st = con.prepareStatement(sql);
        st.setString(1,"%"+query+"%");
        st.setInt(2, start);
        st.setInt(3, end);
        ResultSet rs = st.executeQuery();
        List<Notice> list = new ArrayList<Notice>();
        while (rs.next()) {
            int id = rs.getInt("ID");
            String title = rs.getString("TITLE");
            String writerId = rs.getString("WRITER_ID");
            Date regDate = rs.getDate("REGDATE");
            String content = rs.getString("CONTENT");
            int hit = rs.getInt("hit");

            Notice notice = new Notice(
                    id,
                    title,
                    writerId,
                    regDate,
                    content,
                    hit
            );

            list.add(notice);
        }


        rs.close();
        st.close();
        con.close();

        return list;
    }

    // Scalar 값을 얻어오는 함수 => 단일값을 얻어오는 함수
    public int getCount() throws ClassNotFoundException, SQLException {
        int count = 0;
        String sql = "SELECT COUNT(ID) COUNT FROM NOTICE";

        Class.forName(driver);
        Connection con = DriverManager.getConnection(url, uid, pwd);
        Statement st = con.createStatement();
        ResultSet rs = st.executeQuery(sql);
        if (rs.next()) {
            count = rs.getInt("COUNT");
        }
        rs.close();
        st.close();
        con.close();

        return count;
    }

    public int insert(Notice notice) throws ClassNotFoundException, SQLException {
        String title = notice.getTitle();
        String writerId = notice.getWriterId();
        String content = notice.getContent();

        String sql = "INSERT INTO notice (" +
                "    title," +
                "    writer_id," +
                "    content" +
                ") VALUES (?,?,?)";

        Class.forName(driver);
        Connection con = DriverManager.getConnection(url, uid, pwd);
//        Statement st = con.createStatement();
        PreparedStatement st = con.prepareStatement(sql);
        st.setString(1, title);
        st.setString(2, writerId);
        st.setString(3, content);
        int result = st.executeUpdate();

        st.close();
        con.close();

        return result;
    }

    public int update(Notice notice) throws ClassNotFoundException, SQLException {

        String title = notice.getTitle();
        String content = notice.getContent();
        int id = notice.getId();

        String sql = "UPDATE NOTICE SET " +
                "TITLE=?," +
                "CONTENT=?" +
                "WHERE ID=?";

        Class.forName(driver);
        Connection con = DriverManager.getConnection(url, uid, pwd);
//        Statement st = con.createStatement();
        PreparedStatement st = con.prepareStatement(sql);
        st.setString(1, title);
        st.setString(2, content);
        st.setInt(3, id);

        int result = st.executeUpdate();

        st.close();
        con.close();

        return result;
    }

    public int delete(int id) throws SQLException, ClassNotFoundException {


        String sql = "DELETE NOTICE WHERE ID=?";

        Class.forName(driver);
        Connection con = DriverManager.getConnection(url, uid, pwd);
//        Statement st = con.createStatement();
        PreparedStatement st = con.prepareStatement(sql);
        st.setInt(1, id);

        int result = st.executeUpdate();

        st.close();
        con.close();

        return result;
    }

}

```


***
<br>

    🌜 주관적인 견해가 담긴 글입니다. 다양한 의견이 있으실 경우
    언제든지 댓글 혹은 메일로 지적해주시면 감사하겠습니다! 😄

[맨 위로 이동하기](#){: .btn .btn--primary }{: .align-right}

