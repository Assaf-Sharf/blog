---
layout: single
title: "운영체제 4장"
categories: OS
tag: [OS, 이론]
redirect_from:
    - #/daily/first
---

# 스레드의 개념
## 프로세스와 스레드
- 프로세스는 **자원**을 할당받고 **제어**한다.
- 스레드는 자원과 제어 중 **제어** 부분을 말한다.

## 스레드
- 프로세스는 자원을 제어하기 때문에 이에 대한 정보와 데이터가 담겨있다.
- 제어를 담당하는 부분(스레드)에는 제어 정보(SP, PC, 상태 등), 지역 데이터, 스택 등의 정보와 데이터를 가지고 있다.
- 스레드는 **여러개**가 존재할 수 있고 **자원을 공유**한다.
  - 즉 같은 프로세스의 스레드들은 동일한 주소 공간을 공유한다.

![]({{site.url}}/images/2024-03-16-OS4-images/thread1.png)  

![]({{site.url}}/images/2024-03-16-OS4-images/thread2.png)  

- Light Weight Process (LWP)
  - 가벼운 프로세스란 뜻
  - 일반 프로세스와 달리 자원이 빠진 제어 부분이라
- 프로세서 활용의 기본 단위
- 구성 요소
  - Thread ID
  - Register set (PC, SP 등)
  - Stack

### 스레드의 장점
- 사용자 응답성
  - 일부 스레드의 처리가 지연되도 다른 스레드는 작업을 계속 처리
- 자원 공유
  - 자원을 공유해서 효율성 증가
    - 만약 한 자원을 두고 복수의 프로세스가 처리하면 자원을 공유하지 않아 context switch가 발생해서 커널의 개입이 일어난다. (비효율적)
    - 하지만 스레드는 자원을 공유해 효율적이다.
- 경제성
  - 프로세스의 생성, context switch에 비해 효율적
- 멀티 프로세서 활용
  - 병렬처리를 통해 성능 향상

# 스레드의 구현
## 사용자 수준 스레드 (User Thread)
- 사용자 영역의 스레드 라이브러리로 구현
  - 스레드 생성, 스케줄링 등
  - POSIX threads, Win32 threads, Java thread API 등

### 장점
- 커널은 스레드의 존재를 모름
  - 커널의 관리(개입)를 받지 않음
    - 생성 및 관리의 부하가 적고 유연한 관리가 가능
    - 이식성이 높음

### 단점
- 커널은 프로세스 단위로 자원 할당
  - 하나의 스레드가 block 상태가 되면, 모든 스레드가 대기 (single-threaded kernel 경우)

![]({{site.url}}/images/2024-03-16-OS4-images/thread3.png)  

## 커널 수준 스레드 (Kernel Threads)
- OS (Kernel)가 직접 관리

### 장점
- 커널이 각 스레드를 개별적으로 관리
  - 프로세스 내 스레드들이 병행 수행 가능
    - 하나의 스레드가 block 상태가 되어도, 다른 스레드는 작업 수행 가능

### 단점
- 커널 영역에서 스레드의 생성, 관리 수행
  - Context switching 등 부하(Overhead)가 큼

![]({{site.url}}/images/2024-03-16-OS4-images/thread4.png)  

## Multi-Threading Model
- 다대일(n:1) 모델
  - 사용자 수준 스레드
- 일대일(1:1) 모델
  - 커널 수준 스레드
- 다대다(n:m) 모델
  - n > m
  - - 위 두 모델은 혼합
  - 혼합형 스레드

## 혼합형 스레드
- n개 사용자 수준 스레드 - m개의 커널 스레드 (n>m)
  - 사용자는 원하는 수만 큼 스레드 사용
  - 커널 스레드는 자신에게 할당된 하나의 사용자 스레드가 block 상태가 되어도 다른 스레드 수행 가능
    - 병행 처리 가능
- 효율적이면서 유연

![]({{site.url}}/images/2024-03-16-OS4-images/thread5.png)  