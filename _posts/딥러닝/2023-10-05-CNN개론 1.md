---
title: "CNN개론 1"
escerpt: "CNN 개론 공부"

categories:
  - DeepLearning
tags:
  - [AI, DeepLearning, CNN]

toc: true
toc_sticky: true

breadcrumbs: true

date: 2023-10-05
last_modified_at: 2023-10-05

comments: true
 

---

# 1. 이미지필터(filters)

## 1-1. pixel
: 이미지의 최소한의 단위

- pixel value
: 0(흑) ~ 255(백)

  - 0~255 -> 0~1 로 **normalization** 하는경우도 있다.

## 1-2. RGB
: image는 3channel이 있다.(R,G,B)

![image](https://github.com/OC-JSPark/oc-jspark.github.io/assets/46878973/4f62544d-c635-4534-865f-60a09920490c)

- (R,G,B)를 가진 pixel이 w x h만큼(여기선 4x4), 즉 이미지의 pixel만큼 존재할것이고 그것이 채널갯수만큼 존재한다.
- 즉 3차원 데이터라고 생각하면 된다. 조금더 쉽게 2차원 이미지가 3개 존재한다.채널축은 R,G,B를 의미하는 3개의 이미지가 존재한다

* grayscale: "흑백" 을 의미한다.

## 1-3. 이미지필터
: 3x3 filter(=kernel)

![image](https://github.com/OC-JSPark/oc-jspark.github.io/assets/46878973/bd7d10e5-f901-47c9-9fe3-fe0c7f7d66b2)

  - sharpen filter : 선명효과
  : edge부분이 조금더 선명해진다.  

  - blur fileter : 흐림효과
  : edge부분이 흐려져서, 조금더 자연스럽고 부드럽게 뭉게지는 효과
    - center부터 1/2씩 줄어드는 값을 갖고있다.

  - filter 적용시 input image 보다 output image의 feature map 크기는 작아진다.

- 실습해보기
  - [Image Kernels Explained Visually](https://setosa.io/ev/image-kernels/)

# 2. 합성곱 연산1 (convolution)

## 2-1. 신경망에서의 이미지 입력

![image](https://github.com/OC-JSPark/oc-jspark.github.io/assets/46878973/d858152d-c3bf-410e-a84e-9fa4b7e146d3)

  - 5x5 pixel을 지역적 위치 정보를 없애고 한줄로 만든다.
  - 그렇게 25개의 feature를 가진 matrix가 생성된걸 input node에 들어오게 된다. 
  - 기본적인 feature들의 가중합을 통해 새로운 feature들을 추출한 layer_1이 만들어지고 또한번추출하여 layer_2만들어지고 마지막으로 주어진 데이터들의 다양한 feature들을 추출해서 하나의 예측값을 출력하는 구조이다.

  - 문제점) 이미지내의 region 부분이 필요한데 이러한 정보도 input으로 넣어줘야 인간이 image를 판단할때 그런 정보 활용기법이 유사해진다. 
  - solution) 그래서 cnn기법을 활용하여 region정보도 신경망 모델에 입력시켜서 최종적으로 예측할수 있게 진행되었다.

## 2-2. cnn에서의 이미지 입력
: 각 pixel의 정보를 그대로 사용하는것이 아니라, region정보를 하나의 특성으로 사용하고 싶다. 그러기 위해 어떠한 필터를 사용하여 연산하여 region정보가 포함된 압축된 feature를 만들고 이를 input neural network에 넣을것이다.  

![image](https://github.com/OC-JSPark/oc-jspark.github.io/assets/46878973/1a0cd60b-ba5c-4d67-bc2a-952c2a015385)


  - layer가 깊어질수록 region의 size가 증가하게 된다.
  - 즉, 우리는 input image의 region 정보를 충분히 활용해서 convolution 연산을 통해서 지역적인 정보를 추출해서 다음 layer로 압축한 정보를 넘겨주게 되고 그것을 가중합을 통해서 feature를 생성하고 이런한 과정을 반복한 다음에 최종적으로 굉장히 상세하고, 많은 정보를 담고있는 feature를 활용해서 예측을 진행하게 된다.

- cnn에서의 이미지 입력 workflow 
  - 1) pixel matrix 만든다 
  : input image를 normalization을 활용하여 0~1 사이의 matrix를 만든다. 그리고 grayscale(흑백) 으로 설정한다.

  - 2) convolution 진행한다 
  : input image에 3x3 filter를 적용하여 연산시킨다. 즉, input image에 해당 region의 3x3 filter를 통해서 연산을 통해 나온 압축된 정보를 의미한다.


## 2-3. padding
: input data의 외각에 지정된 pixel만큼 특정 값으로 채워 넣는것을 의미. 

![image](https://github.com/OC-JSPark/oc-jspark.github.io/assets/46878973/e677b088-eeec-426f-a56e-a3e61b55384e)

1. 이를 통해 convolution layer의 출력 데이터의(feature map) 사이즈 조절 가능
2. 외곽을 "0"값으로 둘러싸는 특징으로 부터 인공 신경망이 이미지의 외각을 인식하는 학습효과도 있음.
3. input size와 output size(feature map) 를 동일한 size로 조절가능

## 2-4. stride(=window)
: filter(kernel)가 지정된 간격으로 image를 순회하는 간격을 stride라고 한다.

![image](https://github.com/OC-JSPark/oc-jspark.github.io/assets/46878973/213a3e5c-0a46-4213-95bc-d861b3d748b6)
  - 위 이미지는 stride=1인 경우이다. feature map은 3x3 형태
  - stride = 2로 주게 되면 feature map은 2x2 형태
    - 2칸씩 띄어서 image를 순회하기 때문에 2x2 형태의 feature map이 만들어 진다.

# 3. CNN 1 (convolutional neural networks)


# 6. CNN 2 (convolutional neural networks)
# 7. CNN 역전파
# 8. CV Task - 이미지분류(image classification)
# 9. CV Task - 객체검출(object detection)
# 10. CV Task - 객체추적(object tracking)
# 11. CV Task - 영역분할(segmentation)
# 12. 이미지 전처리(preprocessing)
# 13. 데이터 불균형(imbalance)
# 14. 오버피팅(overfitting)
# 15. 이미지증강(augmentation)



---


[맨 위로 이동하기](#){: .btn .btn--primary }{: .align-right}