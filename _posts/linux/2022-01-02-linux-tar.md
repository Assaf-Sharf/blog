---
layout: single
title: Linux - Tar 
date: 2022-01-02
classes: wide
toc: true
toc_label: "Tabla de contenido"
toc_icon: "clipboard-list"
header:
  teaser: /assets/images/linux/tux.jpg
categories:
  - linux
  - linux-manual
tags:
  - linux-comprimir
  - linux-tar
page_css: 
  - /assets/css/mi-css.css
---

### Tar - Tape ARchive

* Archivador de ficheros
  * **(Fusiona uno o varios archivos en un solo fichero)**

* Se utiliza para **crear** y **manipular** archivos de almacenamiento en sistemas **Unix/Linux**
  * El comando **tar** crea un archivo **.tar** y se puede comprimir su contenido usando como opciones los compresores **gzip** o **bzip2**

* Se utilizan para agrupar archivos, guardarlos dentro de un nuevo archivo comprimido y para extraerlos después de comprimirlos

* Sintaxis básica del comando :

```bash
     ← Crear la extensión .tar
     ↓   ← Crear el archivo añadiendole la extensión .tar
     ↓   ↓              ← Agregarle más opciones al comando como el tipo de compresión
     ↓   ↓              ↓         ← Añadir los archivos y directorios que quiero comprimir
     ↓   ↓              ↓         ↓
tar -c [-f archivo] [opciones] [files...]
```

#### Archivación de ficheros mediante algoritmos de compresión

* En términos generales cada archivo **comprimido** necesita de su mismo **descompresor** para poder **descomprimirlo**

* Existen varias **opciones** para la compresión de ficheros en **Unix/Linux** los cuales se pueden combinar con el archivador **tar** mediante las opciones del comando

  * **gzip** - Compresor instalado en casi todos los sistemas **Linux**
    * **gunzip** - Descompresor estandar
  
  * **zip** - Compresor instalado en casi todos los sistemas **Linux**
    * **unzip** - Descompresor estandar

  * **bzip2** - Compresor más eficiente que **gzip** por ello tarda más en realizar la compresión y consume más CPU
    * **bunzip2** - Descompresor estandar
  
  * **rar** - Compresor
    * **unrar** - Descompresor estandar
  
#### Opciones del comando tar

* c - Crear un nuevo archivo con la extensión ``.tar``

* v - Muestra en pantalla los detalles del proceso de **compresión** o **descompresión** al ejecutar el comando **tar**
  * Es opcional

* f - Asigna el nombre y la extensión del archivo creado
  * Sin esta opción no se generará el archivo **.tar**
    * Ejemplo : ``archivo-comprimido.tar``

#### Opciones del comando para la compresión

* t - Lista el contenido de un archivo comprimido

* z - Comprimir con el compresor ``gzip``
  * Genera la extensión **.gz**

* j - Comprimir con el compresor ``bzip2``
  * Genera las extensiones **.bz2** , **.tar.bz2** , **.tbz2**, **.tb2**

* --exclude - Se usa para excluir archivos en el **proceso de compresión**

##### Ejemplo - Opciones de compresión de ficheros

* Usando la opción ``-c`` creará un archivo con la extensión **.tar** que agrupará un conjunto de **archivos** y **directorios** el cual le hayamos indicado
  * El archivo esta **sin comprimir** lo que significa que no reducirá su peso en memoria
  * Se crea un archivo comprimido ``.tar`` pero no tiene aplicado ninguna reducción de tamaño mediante **compresores de archivos**

```bash
                          ← ← ← ← ← ← ← ← 
                          ↓             ↑ 
tar cvf /path/to/archive.tar /path/to/directory/  # La salida genera un archivo comprimido pero sin algoritmo de compresión : archive.tar 
```

* Crear un archivo **.gz** usando el algoritmo de compresión ``gzip``

```bash
tar zcvf /path/to/archive.tgz /path/to/directory/ # La salida genera el archivo.tgz 
```

* Guarda el contenido de **/etc** y **/var** dentro del fichero **archivo.tar**

```bash
                 ← ← ← ← ← ←
                 ↓    ↑    ↑ 
tar cfp archivo.tar /etc /var # La salida genera el archivo : foo.tar 
```

* Archiva y comprime todo el directorio **/directorio/subdirectorio** con el compresor **gzip**

```bash
tar zcfp archivo.tgz /directorio/subdirectorio
```

* Archiva y comprime con el compresor **bzip2** el directorio **/directorio/subdirectorio**

```bash
tar jcfp archivo.tgz /directorio/subdirectorio
```

##### Ejemplo - Crear archivo comprimido tar sin usar algoritmo de compresión

* No tiene limite a la hora de agregar archivos a la compresión

* Solo recopila todos los archivos dentro de uno solo

```bash
tar cvf archivo.tar archivo1.extension archivo2.extension archivo3.extension
```

##### Ejemplo - Comprimir todo el contenido de un directorio y enviar el archivo comprimido a un directorio concreto

* Copia todo lo que hay dentro del directorio **Documentos** y lo almacena en el directorio **media** con el nombre del archivo ``backup.tar`` o el que le asignemos

```bash
                  ← ← ← ← ← ← ← ← ← ← ← ← ← ←
                  ↓                         ↑    
tar cvf /media/backup.tar /home/usuario/Documentos/
```

##### Ejemplo - Añadir archivos o directorios a un archivo tar

* Para añadir archivos o directorios a los ficheros del archivo tar existentes utilizando la opción r (append)
  * Añadimos el archivo xyz.txt y el directorio php al archivo prueba.tar existente.

```bash
tar rvf prueba.tar xyz.txt
```

```bash
tar rvf prueba.tar php
```

##### Ejemplo - Ver contenido del archivo

```bash
tar tf archivo.tar
```

##### Ejemplo - Listar contenido del archivo comprimido tar

```bash
tar -tvf archivo.tar
```

### Untar - Descomprimir archivos tar

* **Descomprimir/Extraer** un archivo **.tar** solamente emitimos el siguiente comando usando la opción **x**

```bash
tar xvf archivo.tar
```

* **Descomprimir/Extraer** todo el contenido del **archivo.tar**

```bash
tar xfp archivo.tar 
```

* **Descomprimir/Extraer** archivos con el algoritmo ``gzip``

```bash
tar xvf archivo.tar.gz
```

* **Descomprimir/Extraer** archivos con el algoritmo ``bzip2``

```bash
tar xvf archivo.tar.bz2
```

* **Descomprimir/Extraer** el fichero anterior

```bash
tar zxfp archivo.tgz 
```

* **Descomprimir/Extraer** en un directorio especifico indicado mediante la opción ``-C``

```bash
tar xvf archivo.tar -C /home/usuario/videos/
```

* **Descomprimir/Extraer** un archivo especifico desde un archivo **tar** en Linux
  * ``--extract`` → Opción para descomprimir un archivo
  * ``--file=`` → Opción para especificar el archivo especifico

```bash
tar xvf --file=script.sh.tar script.sh
tar --extract --file=script.sh.tar script.sh
```

* **Descomprimir/Extraer** un archivo especifico desde un archivo **tar.gz** en Linux
  * ``--extract`` → Opción para descomprimir un archivo
  * ``--file=`` → Opción para especificar el archivo especifico

```bash
tar zxvf archivo.tar.gz archivo.xml
tar --extract --file=archivo.tar.gz archivo.xml
```

* **Descomprimir/Extraer** un archivo especifico desde un archivo **tar.bz2** en Linux

```bash
tar jxvf archivo.tar.bz2 home/php/index.php
tar --extract --file=archivo.tar.bz2 /home/php/index.php
/home/php/index.php # Salida
```

* **Descomprimir/Extraer** varios archivos de **tar**, **tar.gz** y **tar.bz2**
  * Para extraer múltiples ficheros del archivo **tar**, **tar.gz** y **tar.bz2**
    * Ejemplo : el siguiente comando extraerá el "archivo 1" y el "archivo 2" del archivo.

```bash
tar xvf archivo.tar "archivo1" "archivo2"
```

```bash
tar zxvf archivo.tar.gz "archivo1" "archivo2"
```

```bash
tar jxvf archivo.tar.bz2 "archivo1" "archivo2"
```

* **Descomprimir/Extraer** un grupo de archivos usando un **comodín/wildcard** en Linux
  * ``--wildcards`` → Opción que permite el uso de **comodines/wildcard**

```bash
tar xvf archivos.tar --wildcards '*.php'
tar zxvf archivo.tar.gz --wildcards '*.php'
tar jxvf archivo.tar.bz2 --wildcards '*.php
```




<!-- 
##### Ejemplo - Verificar si los archivos tar son tar.gz o tar.bz2

* Para verificar cualquier archivo **tar** o comprimido utilizamos la opción **W** (verificar)

* Para ello, basta con utilizar los siguientes ejemplos de comando
  * No se puede hacer una verificación en un archivo comprimido de los archivos
    * ``*.tar.gz``
    * ``*.tar.bz2``

```bash
tar tvfW archivo.tar
``` 
-->