```python
import warnings
warnings.filterwarnings('ignore')
from IPython.display import Image
import numpy as np
import pandas as pd
```


```python
#Pew Research Center는 세계의 여론 조사, 인구 통계 
#등 다양한 사회 과학 연구를 수행하는 곳이다.
#Pew Research Center에서 조사한 '미국의 소득과 종교'
#데이터를 사용한다.
pew = pd.read_csv('./data/pew.csv')
pew
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>religion</th>
      <th>&lt;$10k</th>
      <th>$10-20k</th>
      <th>$20-30k</th>
      <th>$30-40k</th>
      <th>$40-50k</th>
      <th>$50-75k</th>
      <th>$75-100k</th>
      <th>$100-150k</th>
      <th>&gt;150k</th>
      <th>Don't know/refused</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Agnostic</td>
      <td>27</td>
      <td>34</td>
      <td>60</td>
      <td>81</td>
      <td>76</td>
      <td>137</td>
      <td>122</td>
      <td>109</td>
      <td>84</td>
      <td>96</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Atheist</td>
      <td>12</td>
      <td>27</td>
      <td>37</td>
      <td>52</td>
      <td>35</td>
      <td>70</td>
      <td>73</td>
      <td>59</td>
      <td>74</td>
      <td>76</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Buddhist</td>
      <td>27</td>
      <td>21</td>
      <td>30</td>
      <td>34</td>
      <td>33</td>
      <td>58</td>
      <td>62</td>
      <td>39</td>
      <td>53</td>
      <td>54</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Catholic</td>
      <td>418</td>
      <td>617</td>
      <td>732</td>
      <td>670</td>
      <td>638</td>
      <td>1116</td>
      <td>949</td>
      <td>792</td>
      <td>633</td>
      <td>1489</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Don’t know/refused</td>
      <td>15</td>
      <td>14</td>
      <td>15</td>
      <td>11</td>
      <td>10</td>
      <td>35</td>
      <td>21</td>
      <td>17</td>
      <td>18</td>
      <td>116</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Evangelical Prot</td>
      <td>575</td>
      <td>869</td>
      <td>1064</td>
      <td>982</td>
      <td>881</td>
      <td>1486</td>
      <td>949</td>
      <td>723</td>
      <td>414</td>
      <td>1529</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hindu</td>
      <td>1</td>
      <td>9</td>
      <td>7</td>
      <td>9</td>
      <td>11</td>
      <td>34</td>
      <td>47</td>
      <td>48</td>
      <td>54</td>
      <td>37</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Historically Black Prot</td>
      <td>228</td>
      <td>244</td>
      <td>236</td>
      <td>238</td>
      <td>197</td>
      <td>223</td>
      <td>131</td>
      <td>81</td>
      <td>78</td>
      <td>339</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Jehovah's Witness</td>
      <td>20</td>
      <td>27</td>
      <td>24</td>
      <td>24</td>
      <td>21</td>
      <td>30</td>
      <td>15</td>
      <td>11</td>
      <td>6</td>
      <td>37</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Jewish</td>
      <td>19</td>
      <td>19</td>
      <td>25</td>
      <td>25</td>
      <td>30</td>
      <td>95</td>
      <td>69</td>
      <td>87</td>
      <td>151</td>
      <td>162</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Mainline Prot</td>
      <td>289</td>
      <td>495</td>
      <td>619</td>
      <td>655</td>
      <td>651</td>
      <td>1107</td>
      <td>939</td>
      <td>753</td>
      <td>634</td>
      <td>1328</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mormon</td>
      <td>29</td>
      <td>40</td>
      <td>48</td>
      <td>51</td>
      <td>56</td>
      <td>112</td>
      <td>85</td>
      <td>49</td>
      <td>42</td>
      <td>69</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Muslim</td>
      <td>6</td>
      <td>7</td>
      <td>9</td>
      <td>10</td>
      <td>9</td>
      <td>23</td>
      <td>16</td>
      <td>8</td>
      <td>6</td>
      <td>22</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Orthodox</td>
      <td>13</td>
      <td>17</td>
      <td>23</td>
      <td>32</td>
      <td>32</td>
      <td>47</td>
      <td>38</td>
      <td>42</td>
      <td>46</td>
      <td>73</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Other Christian</td>
      <td>9</td>
      <td>7</td>
      <td>11</td>
      <td>13</td>
      <td>13</td>
      <td>14</td>
      <td>18</td>
      <td>14</td>
      <td>12</td>
      <td>18</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Other Faiths</td>
      <td>20</td>
      <td>33</td>
      <td>40</td>
      <td>46</td>
      <td>49</td>
      <td>63</td>
      <td>46</td>
      <td>40</td>
      <td>41</td>
      <td>71</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Other World Religions</td>
      <td>5</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>2</td>
      <td>7</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>8</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Unaffiliated</td>
      <td>217</td>
      <td>299</td>
      <td>374</td>
      <td>365</td>
      <td>341</td>
      <td>528</td>
      <td>407</td>
      <td>321</td>
      <td>258</td>
      <td>597</td>
    </tr>
  </tbody>
</table>
</div>


```python
#melt() 함수
#데이터프레임을 깔끔한 데이터로 정리하는데 사용하는 melt() 함수는 지정한 열의 데이터를 모두 행으로 정리한다.
#melt(데이터프레임, id_vars[, value_vars, var_name, value_name])
#id_vars => 위치를 그대로 유지할 열 이름
#value_vars => 행으로 위치를 변경할 열 이름
#var_name => value_vars로 위치를 변경한 열 이름을 지정한다.
#value_name => var_name으로 위치를 변경한 열의 데이터를 지정한 열 이름을 지정한다.
```


```python
#소득 정보가 열을 구성하고 있다. => 소득 정보 열을 행 데이터로 옮긴다.
#id_vars 속성으로 지정한 열(religion)을 제외한 나머지 소득 정보 열(
#<$10k,$10-20k,$20-30k,...Don't know/refused)이 varaible열로, 소득 정보
#열의 데이터는 value열로 정리가 되고 value_vars를 생략하면 모든 열을
#대상으로 함수가 실행된다.

#이런 과정을 'religion'열을 고정해서 '피벗했다'라고 말한다.

per_long=pd.melt(pew, id_vars='religion')
per_long.head(50)
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>religion</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Agnostic</td>
      <td>&lt;$10k</td>
      <td>27</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Atheist</td>
      <td>&lt;$10k</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Buddhist</td>
      <td>&lt;$10k</td>
      <td>27</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Catholic</td>
      <td>&lt;$10k</td>
      <td>418</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Don’t know/refused</td>
      <td>&lt;$10k</td>
      <td>15</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Evangelical Prot</td>
      <td>&lt;$10k</td>
      <td>575</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hindu</td>
      <td>&lt;$10k</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Historically Black Prot</td>
      <td>&lt;$10k</td>
      <td>228</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Jehovah's Witness</td>
      <td>&lt;$10k</td>
      <td>20</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Jewish</td>
      <td>&lt;$10k</td>
      <td>19</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Mainline Prot</td>
      <td>&lt;$10k</td>
      <td>289</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mormon</td>
      <td>&lt;$10k</td>
      <td>29</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Muslim</td>
      <td>&lt;$10k</td>
      <td>6</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Orthodox</td>
      <td>&lt;$10k</td>
      <td>13</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Other Christian</td>
      <td>&lt;$10k</td>
      <td>9</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Other Faiths</td>
      <td>&lt;$10k</td>
      <td>20</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Other World Religions</td>
      <td>&lt;$10k</td>
      <td>5</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Unaffiliated</td>
      <td>&lt;$10k</td>
      <td>217</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Agnostic</td>
      <td>$10-20k</td>
      <td>34</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Atheist</td>
      <td>$10-20k</td>
      <td>27</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Buddhist</td>
      <td>$10-20k</td>
      <td>21</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Catholic</td>
      <td>$10-20k</td>
      <td>617</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Don’t know/refused</td>
      <td>$10-20k</td>
      <td>14</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Evangelical Prot</td>
      <td>$10-20k</td>
      <td>869</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Hindu</td>
      <td>$10-20k</td>
      <td>9</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Historically Black Prot</td>
      <td>$10-20k</td>
      <td>244</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Jehovah's Witness</td>
      <td>$10-20k</td>
      <td>27</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Jewish</td>
      <td>$10-20k</td>
      <td>19</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Mainline Prot</td>
      <td>$10-20k</td>
      <td>495</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Mormon</td>
      <td>$10-20k</td>
      <td>40</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Muslim</td>
      <td>$10-20k</td>
      <td>7</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Orthodox</td>
      <td>$10-20k</td>
      <td>17</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Other Christian</td>
      <td>$10-20k</td>
      <td>7</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Other Faiths</td>
      <td>$10-20k</td>
      <td>33</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Other World Religions</td>
      <td>$10-20k</td>
      <td>2</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Unaffiliated</td>
      <td>$10-20k</td>
      <td>299</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Agnostic</td>
      <td>$20-30k</td>
      <td>60</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Atheist</td>
      <td>$20-30k</td>
      <td>37</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Buddhist</td>
      <td>$20-30k</td>
      <td>30</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Catholic</td>
      <td>$20-30k</td>
      <td>732</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Don’t know/refused</td>
      <td>$20-30k</td>
      <td>15</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Evangelical Prot</td>
      <td>$20-30k</td>
      <td>1064</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Hindu</td>
      <td>$20-30k</td>
      <td>7</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Historically Black Prot</td>
      <td>$20-30k</td>
      <td>236</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Jehovah's Witness</td>
      <td>$20-30k</td>
      <td>24</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Jewish</td>
      <td>$20-30k</td>
      <td>25</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Mainline Prot</td>
      <td>$20-30k</td>
      <td>619</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Mormon</td>
      <td>$20-30k</td>
      <td>48</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Muslim</td>
      <td>$20-30k</td>
      <td>9</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Orthodox</td>
      <td>$20-30k</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
</div>


```python
#value_vars 속성을 지정하면 지정한 열만 대상으로 피벗한다.
per_long = pd.melt(pew, id_vars='religion', value_vars='$20-30k')
per_long
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>religion</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Agnostic</td>
      <td>$20-30k</td>
      <td>60</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Atheist</td>
      <td>$20-30k</td>
      <td>37</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Buddhist</td>
      <td>$20-30k</td>
      <td>30</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Catholic</td>
      <td>$20-30k</td>
      <td>732</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Don’t know/refused</td>
      <td>$20-30k</td>
      <td>15</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Evangelical Prot</td>
      <td>$20-30k</td>
      <td>1064</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hindu</td>
      <td>$20-30k</td>
      <td>7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Historically Black Prot</td>
      <td>$20-30k</td>
      <td>236</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Jehovah's Witness</td>
      <td>$20-30k</td>
      <td>24</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Jewish</td>
      <td>$20-30k</td>
      <td>25</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Mainline Prot</td>
      <td>$20-30k</td>
      <td>619</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mormon</td>
      <td>$20-30k</td>
      <td>48</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Muslim</td>
      <td>$20-30k</td>
      <td>9</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Orthodox</td>
      <td>$20-30k</td>
      <td>23</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Other Christian</td>
      <td>$20-30k</td>
      <td>11</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Other Faiths</td>
      <td>$20-30k</td>
      <td>40</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Other World Religions</td>
      <td>$20-30k</td>
      <td>3</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Unaffiliated</td>
      <td>$20-30k</td>
      <td>374</td>
    </tr>
  </tbody>
</table>
</div>


```python
per_long = pd.melt(pew, id_vars='religion', value_vars=['$10-20k','$100-150k'])
per_long
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>religion</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Agnostic</td>
      <td>$10-20k</td>
      <td>34</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Atheist</td>
      <td>$10-20k</td>
      <td>27</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Buddhist</td>
      <td>$10-20k</td>
      <td>21</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Catholic</td>
      <td>$10-20k</td>
      <td>617</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Don’t know/refused</td>
      <td>$10-20k</td>
      <td>14</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Evangelical Prot</td>
      <td>$10-20k</td>
      <td>869</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hindu</td>
      <td>$10-20k</td>
      <td>9</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Historically Black Prot</td>
      <td>$10-20k</td>
      <td>244</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Jehovah's Witness</td>
      <td>$10-20k</td>
      <td>27</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Jewish</td>
      <td>$10-20k</td>
      <td>19</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Mainline Prot</td>
      <td>$10-20k</td>
      <td>495</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mormon</td>
      <td>$10-20k</td>
      <td>40</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Muslim</td>
      <td>$10-20k</td>
      <td>7</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Orthodox</td>
      <td>$10-20k</td>
      <td>17</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Other Christian</td>
      <td>$10-20k</td>
      <td>7</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Other Faiths</td>
      <td>$10-20k</td>
      <td>33</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Other World Religions</td>
      <td>$10-20k</td>
      <td>2</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Unaffiliated</td>
      <td>$10-20k</td>
      <td>299</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Agnostic</td>
      <td>$100-150k</td>
      <td>109</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Atheist</td>
      <td>$100-150k</td>
      <td>59</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Buddhist</td>
      <td>$100-150k</td>
      <td>39</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Catholic</td>
      <td>$100-150k</td>
      <td>792</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Don’t know/refused</td>
      <td>$100-150k</td>
      <td>17</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Evangelical Prot</td>
      <td>$100-150k</td>
      <td>723</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Hindu</td>
      <td>$100-150k</td>
      <td>48</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Historically Black Prot</td>
      <td>$100-150k</td>
      <td>81</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Jehovah's Witness</td>
      <td>$100-150k</td>
      <td>11</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Jewish</td>
      <td>$100-150k</td>
      <td>87</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Mainline Prot</td>
      <td>$100-150k</td>
      <td>753</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Mormon</td>
      <td>$100-150k</td>
      <td>49</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Muslim</td>
      <td>$100-150k</td>
      <td>8</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Orthodox</td>
      <td>$100-150k</td>
      <td>42</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Other Christian</td>
      <td>$100-150k</td>
      <td>14</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Other Faiths</td>
      <td>$100-150k</td>
      <td>40</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Other World Religions</td>
      <td>$100-150k</td>
      <td>4</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Unaffiliated</td>
      <td>$100-150k</td>
      <td>321</td>
    </tr>
  </tbody>
</table>
</div>


```python
#var_name 속성을 이용해서 variable로 표시되던 열 이름을 변경한다.
#value_name 속성을 이용해서 value로 표시되던 열 이름을 변경한다.
per_long = pd.melt(pew, id_vars='religion', value_vars=['$10-20k','$100-150k'], 
                   var_name='최저임금', value_name="인원수")
per_long
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>religion</th>
      <th>최저임금</th>
      <th>인원수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Agnostic</td>
      <td>$10-20k</td>
      <td>34</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Atheist</td>
      <td>$10-20k</td>
      <td>27</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Buddhist</td>
      <td>$10-20k</td>
      <td>21</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Catholic</td>
      <td>$10-20k</td>
      <td>617</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Don’t know/refused</td>
      <td>$10-20k</td>
      <td>14</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Evangelical Prot</td>
      <td>$10-20k</td>
      <td>869</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hindu</td>
      <td>$10-20k</td>
      <td>9</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Historically Black Prot</td>
      <td>$10-20k</td>
      <td>244</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Jehovah's Witness</td>
      <td>$10-20k</td>
      <td>27</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Jewish</td>
      <td>$10-20k</td>
      <td>19</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Mainline Prot</td>
      <td>$10-20k</td>
      <td>495</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mormon</td>
      <td>$10-20k</td>
      <td>40</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Muslim</td>
      <td>$10-20k</td>
      <td>7</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Orthodox</td>
      <td>$10-20k</td>
      <td>17</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Other Christian</td>
      <td>$10-20k</td>
      <td>7</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Other Faiths</td>
      <td>$10-20k</td>
      <td>33</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Other World Religions</td>
      <td>$10-20k</td>
      <td>2</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Unaffiliated</td>
      <td>$10-20k</td>
      <td>299</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Agnostic</td>
      <td>$100-150k</td>
      <td>109</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Atheist</td>
      <td>$100-150k</td>
      <td>59</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Buddhist</td>
      <td>$100-150k</td>
      <td>39</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Catholic</td>
      <td>$100-150k</td>
      <td>792</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Don’t know/refused</td>
      <td>$100-150k</td>
      <td>17</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Evangelical Prot</td>
      <td>$100-150k</td>
      <td>723</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Hindu</td>
      <td>$100-150k</td>
      <td>48</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Historically Black Prot</td>
      <td>$100-150k</td>
      <td>81</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Jehovah's Witness</td>
      <td>$100-150k</td>
      <td>11</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Jewish</td>
      <td>$100-150k</td>
      <td>87</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Mainline Prot</td>
      <td>$100-150k</td>
      <td>753</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Mormon</td>
      <td>$100-150k</td>
      <td>49</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Muslim</td>
      <td>$100-150k</td>
      <td>8</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Orthodox</td>
      <td>$100-150k</td>
      <td>42</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Other Christian</td>
      <td>$100-150k</td>
      <td>14</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Other Faiths</td>
      <td>$100-150k</td>
      <td>40</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Other World Religions</td>
      <td>$100-150k</td>
      <td>4</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Unaffiliated</td>
      <td>$100-150k</td>
      <td>321</td>
    </tr>
  </tbody>
</table>
</div>


```python
per_long = pd.melt(pew, id_vars='religion', value_vars=['$10-20k','$100-150k'])
per_long.columns = ["종교", "최저임금", "인원수"]
per_long
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종교</th>
      <th>최저임금</th>
      <th>인원수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Agnostic</td>
      <td>$10-20k</td>
      <td>34</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Atheist</td>
      <td>$10-20k</td>
      <td>27</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Buddhist</td>
      <td>$10-20k</td>
      <td>21</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Catholic</td>
      <td>$10-20k</td>
      <td>617</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Don’t know/refused</td>
      <td>$10-20k</td>
      <td>14</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Evangelical Prot</td>
      <td>$10-20k</td>
      <td>869</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hindu</td>
      <td>$10-20k</td>
      <td>9</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Historically Black Prot</td>
      <td>$10-20k</td>
      <td>244</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Jehovah's Witness</td>
      <td>$10-20k</td>
      <td>27</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Jewish</td>
      <td>$10-20k</td>
      <td>19</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Mainline Prot</td>
      <td>$10-20k</td>
      <td>495</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mormon</td>
      <td>$10-20k</td>
      <td>40</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Muslim</td>
      <td>$10-20k</td>
      <td>7</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Orthodox</td>
      <td>$10-20k</td>
      <td>17</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Other Christian</td>
      <td>$10-20k</td>
      <td>7</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Other Faiths</td>
      <td>$10-20k</td>
      <td>33</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Other World Religions</td>
      <td>$10-20k</td>
      <td>2</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Unaffiliated</td>
      <td>$10-20k</td>
      <td>299</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Agnostic</td>
      <td>$100-150k</td>
      <td>109</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Atheist</td>
      <td>$100-150k</td>
      <td>59</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Buddhist</td>
      <td>$100-150k</td>
      <td>39</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Catholic</td>
      <td>$100-150k</td>
      <td>792</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Don’t know/refused</td>
      <td>$100-150k</td>
      <td>17</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Evangelical Prot</td>
      <td>$100-150k</td>
      <td>723</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Hindu</td>
      <td>$100-150k</td>
      <td>48</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Historically Black Prot</td>
      <td>$100-150k</td>
      <td>81</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Jehovah's Witness</td>
      <td>$100-150k</td>
      <td>11</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Jewish</td>
      <td>$100-150k</td>
      <td>87</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Mainline Prot</td>
      <td>$100-150k</td>
      <td>753</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Mormon</td>
      <td>$100-150k</td>
      <td>49</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Muslim</td>
      <td>$100-150k</td>
      <td>8</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Orthodox</td>
      <td>$100-150k</td>
      <td>42</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Other Christian</td>
      <td>$100-150k</td>
      <td>14</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Other Faiths</td>
      <td>$100-150k</td>
      <td>40</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Other World Religions</td>
      <td>$100-150k</td>
      <td>4</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Unaffiliated</td>
      <td>$100-150k</td>
      <td>321</td>
    </tr>
  </tbody>
</table>
</div>


```python
ebola = pd.read_csv("./data/country_timeseries.csv")
ebola.head()
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Day</th>
      <th>Cases_Guinea</th>
      <th>Cases_Liberia</th>
      <th>Cases_SierraLeone</th>
      <th>Cases_Nigeria</th>
      <th>Cases_Senegal</th>
      <th>Cases_UnitedStates</th>
      <th>Cases_Spain</th>
      <th>Cases_Mali</th>
      <th>Deaths_Guinea</th>
      <th>Deaths_Liberia</th>
      <th>Deaths_SierraLeone</th>
      <th>Deaths_Nigeria</th>
      <th>Deaths_Senegal</th>
      <th>Deaths_UnitedStates</th>
      <th>Deaths_Spain</th>
      <th>Deaths_Mali</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1/5/2015</td>
      <td>289</td>
      <td>2776.0</td>
      <td>NaN</td>
      <td>10030.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1786.0</td>
      <td>NaN</td>
      <td>2977.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1/4/2015</td>
      <td>288</td>
      <td>2775.0</td>
      <td>NaN</td>
      <td>9780.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1781.0</td>
      <td>NaN</td>
      <td>2943.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1/3/2015</td>
      <td>287</td>
      <td>2769.0</td>
      <td>8166.0</td>
      <td>9722.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1767.0</td>
      <td>3496.0</td>
      <td>2915.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1/2/2015</td>
      <td>286</td>
      <td>NaN</td>
      <td>8157.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3496.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12/31/2014</td>
      <td>284</td>
      <td>2730.0</td>
      <td>8115.0</td>
      <td>9633.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1739.0</td>
      <td>3471.0</td>
      <td>2827.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>


```python
#ebola_sub_set=ebola.iloc[:, [0,1,2,3, 10,11]]
ebola_sub_set = ebola.loc[:, ['Date','Day','Cases_Guinea','Cases_Liberia', 'Deaths_Guinea', 'Deaths_Liberia']]
ebola_sub_set.head()
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Day</th>
      <th>Cases_Guinea</th>
      <th>Cases_Liberia</th>
      <th>Deaths_Guinea</th>
      <th>Deaths_Liberia</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1/5/2015</td>
      <td>289</td>
      <td>2776.0</td>
      <td>NaN</td>
      <td>1786.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1/4/2015</td>
      <td>288</td>
      <td>2775.0</td>
      <td>NaN</td>
      <td>1781.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1/3/2015</td>
      <td>287</td>
      <td>2769.0</td>
      <td>8166.0</td>
      <td>1767.0</td>
      <td>3496.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1/2/2015</td>
      <td>286</td>
      <td>NaN</td>
      <td>8157.0</td>
      <td>NaN</td>
      <td>3496.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12/31/2014</td>
      <td>284</td>
      <td>2730.0</td>
      <td>8115.0</td>
      <td>1739.0</td>
      <td>3471.0</td>
    </tr>
  </tbody>
</table>
</div>


```python
#Date와 Days를 고정하고 나머지를 행으로 피벗하면
#각 나라별 환자 수와 사망자 수를 볼 수 있다.
ebola_long = pd.melt(ebola_sub_set, id_vars=['Date', 'Day'])
ebola_long.columns = ['날짜', '경과일', '국가명', '인원수']
ebola_long
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>경과일</th>
      <th>국가명</th>
      <th>인원수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1/5/2015</td>
      <td>289</td>
      <td>Cases_Guinea</td>
      <td>2776.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1/4/2015</td>
      <td>288</td>
      <td>Cases_Guinea</td>
      <td>2775.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1/3/2015</td>
      <td>287</td>
      <td>Cases_Guinea</td>
      <td>2769.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1/2/2015</td>
      <td>286</td>
      <td>Cases_Guinea</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12/31/2014</td>
      <td>284</td>
      <td>Cases_Guinea</td>
      <td>2730.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>483</th>
      <td>3/27/2014</td>
      <td>5</td>
      <td>Deaths_Liberia</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>484</th>
      <td>3/26/2014</td>
      <td>4</td>
      <td>Deaths_Liberia</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>485</th>
      <td>3/25/2014</td>
      <td>3</td>
      <td>Deaths_Liberia</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>486</th>
      <td>3/24/2014</td>
      <td>2</td>
      <td>Deaths_Liberia</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>487</th>
      <td>3/22/2014</td>
      <td>0</td>
      <td>Deaths_Liberia</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>488 rows × 4 columns</p>
</div>


```python
#split()함수의 인수에 '_'를 구분자로 전달하면
#'Cases_Guinea'를 'Cases'와 'Guinea'로 분리할 수 있다.

print(type(ebola_long['국가명']))
print(type(ebola_long.국가명))

#split()은 문자열 데이터에 사용하는 함수다.
#시리즈에는 문자열 함수를 사용할 수 없으므로
#str을 사용해서 문자열로 변환한 후 사용한다.
print(type(ebola_long['국가명'].str))
print(type(ebola_long.국가명.str))

variable_split = ebola_long['국가명'].str.split('_')
print('='*80)

#분리된 데이터 전체는 시리즈 타입의 데이터이다.
print(type(variable_split))
print(variable_split.head())
print('='*80)

#분리된 데이터에서 특정 위치의 데이터만 얻어오려면
#리스트 타입의 데이터이다.(시리즈 내에 자료는 리스트들로 구성)
print(type(variable_split[0]))
#print(variable_split[300])도 해보자
print(variable_split[0])
print(variable_split[0][0])   #상태
print(variable_split[0][1])   #국가명

```

    <class 'pandas.core.series.Series'>
    <class 'pandas.core.series.Series'>
    <class 'pandas.core.strings.StringMethods'>
    <class 'pandas.core.strings.StringMethods'>
    ================================================================================
    <class 'pandas.core.series.Series'>
    0    [Cases, Guinea]
    1    [Cases, Guinea]
    2    [Cases, Guinea]
    3    [Cases, Guinea]
    4    [Cases, Guinea]
    Name: 국가명, dtype: object
    ================================================================================
    <class 'list'>
    ['Cases', 'Guinea']
    Cases
    Guinea

```python
print(type(variable_split))
print(variable_split.head())
print('='*80)
print(variable_split.str[0].head())  #상태
print('='*80)
print(variable_split.str[1].head())  #국가
print('='*80)
print(variable_split.str.get(0).head())  #상태
print('='*80)
print(variable_split.str.get(1).head())  #국가
```

    <class 'pandas.core.series.Series'>
    0    [Cases, Guinea]
    1    [Cases, Guinea]
    2    [Cases, Guinea]
    3    [Cases, Guinea]
    4    [Cases, Guinea]
    Name: 국가명, dtype: object
    ================================================================================
    0    Cases
    1    Cases
    2    Cases
    3    Cases
    4    Cases
    Name: 국가명, dtype: object
    ================================================================================
    0    Guinea
    1    Guinea
    2    Guinea
    3    Guinea
    4    Guinea
    Name: 국가명, dtype: object
    ================================================================================
    0    Cases
    1    Cases
    2    Cases
    3    Cases
    4    Cases
    Name: 국가명, dtype: object
    ================================================================================
    0    Guinea
    1    Guinea
    2    Guinea
    3    Guinea
    4    Guinea
    Name: 국가명, dtype: object

```python
status_values = variable_split.str[0]
print(status_values.head())
print()
country_values = variable_split.str.get(1)
print(country_values.head())
```

    0    Cases
    1    Cases
    2    Cases
    3    Cases
    4    Cases
    Name: 국가명, dtype: object
    
    0    Guinea
    1    Guinea
    2    Guinea
    3    Guinea
    4    Guinea
    Name: 국가명, dtype: object

```python
print(ebola_long.columns)
ebola_long['상태'] = status_values
ebola_long['국가'] = country_values
ebola_long
```

    Index(['날짜', '경과일', '국가명', '인원수'], dtype='object')



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>경과일</th>
      <th>국가명</th>
      <th>인원수</th>
      <th>상태</th>
      <th>국가</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1/5/2015</td>
      <td>289</td>
      <td>Cases_Guinea</td>
      <td>2776.0</td>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1/4/2015</td>
      <td>288</td>
      <td>Cases_Guinea</td>
      <td>2775.0</td>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1/3/2015</td>
      <td>287</td>
      <td>Cases_Guinea</td>
      <td>2769.0</td>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1/2/2015</td>
      <td>286</td>
      <td>Cases_Guinea</td>
      <td>NaN</td>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12/31/2014</td>
      <td>284</td>
      <td>Cases_Guinea</td>
      <td>2730.0</td>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>483</th>
      <td>3/27/2014</td>
      <td>5</td>
      <td>Deaths_Liberia</td>
      <td>6.0</td>
      <td>Deaths</td>
      <td>Liberia</td>
    </tr>
    <tr>
      <th>484</th>
      <td>3/26/2014</td>
      <td>4</td>
      <td>Deaths_Liberia</td>
      <td>NaN</td>
      <td>Deaths</td>
      <td>Liberia</td>
    </tr>
    <tr>
      <th>485</th>
      <td>3/25/2014</td>
      <td>3</td>
      <td>Deaths_Liberia</td>
      <td>NaN</td>
      <td>Deaths</td>
      <td>Liberia</td>
    </tr>
    <tr>
      <th>486</th>
      <td>3/24/2014</td>
      <td>2</td>
      <td>Deaths_Liberia</td>
      <td>NaN</td>
      <td>Deaths</td>
      <td>Liberia</td>
    </tr>
    <tr>
      <th>487</th>
      <td>3/22/2014</td>
      <td>0</td>
      <td>Deaths_Liberia</td>
      <td>NaN</td>
      <td>Deaths</td>
      <td>Liberia</td>
    </tr>
  </tbody>
</table>
<p>488 rows × 6 columns</p>
</div>


```python
variable_split = ebola_long.국가명.str.split('_')
print(type(variable_split))

#까먹지 말아야 할것
#split()함수에 expend 옵션을 True로 지정하면 구분자를
#경계로 분리한 데이터를 하나의 데이터프레임으로 리턴한다.
#(False가 기본값)
variable_split = ebola_long.국가명.str.split('_', expand=True)
print(type(variable_split))
variable_split.head()

#열이름을 설정한다.
variable_split.columns=['상태2', '국가2']
variable_split.head()
```

    <class 'pandas.core.series.Series'>
    <class 'pandas.core.frame.DataFrame'>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>상태2</th>
      <th>국가2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
  </tbody>
</table>
</div>


```python
ebola_parsed = pd.concat([ebola_long, variable_split], axis=1)
ebola_parsed
```


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>경과일</th>
      <th>국가명</th>
      <th>인원수</th>
      <th>상태</th>
      <th>국가</th>
      <th>상태2</th>
      <th>국가2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1/5/2015</td>
      <td>289</td>
      <td>Cases_Guinea</td>
      <td>2776.0</td>
      <td>Cases</td>
      <td>Guinea</td>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1/4/2015</td>
      <td>288</td>
      <td>Cases_Guinea</td>
      <td>2775.0</td>
      <td>Cases</td>
      <td>Guinea</td>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1/3/2015</td>
      <td>287</td>
      <td>Cases_Guinea</td>
      <td>2769.0</td>
      <td>Cases</td>
      <td>Guinea</td>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1/2/2015</td>
      <td>286</td>
      <td>Cases_Guinea</td>
      <td>NaN</td>
      <td>Cases</td>
      <td>Guinea</td>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12/31/2014</td>
      <td>284</td>
      <td>Cases_Guinea</td>
      <td>2730.0</td>
      <td>Cases</td>
      <td>Guinea</td>
      <td>Cases</td>
      <td>Guinea</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>483</th>
      <td>3/27/2014</td>
      <td>5</td>
      <td>Deaths_Liberia</td>
      <td>6.0</td>
      <td>Deaths</td>
      <td>Liberia</td>
      <td>Deaths</td>
      <td>Liberia</td>
    </tr>
    <tr>
      <th>484</th>
      <td>3/26/2014</td>
      <td>4</td>
      <td>Deaths_Liberia</td>
      <td>NaN</td>
      <td>Deaths</td>
      <td>Liberia</td>
      <td>Deaths</td>
      <td>Liberia</td>
    </tr>
    <tr>
      <th>485</th>
      <td>3/25/2014</td>
      <td>3</td>
      <td>Deaths_Liberia</td>
      <td>NaN</td>
      <td>Deaths</td>
      <td>Liberia</td>
      <td>Deaths</td>
      <td>Liberia</td>
    </tr>
    <tr>
      <th>486</th>
      <td>3/24/2014</td>
      <td>2</td>
      <td>Deaths_Liberia</td>
      <td>NaN</td>
      <td>Deaths</td>
      <td>Liberia</td>
      <td>Deaths</td>
      <td>Liberia</td>
    </tr>
    <tr>
      <th>487</th>
      <td>3/22/2014</td>
      <td>0</td>
      <td>Deaths_Liberia</td>
      <td>NaN</td>
      <td>Deaths</td>
      <td>Liberia</td>
      <td>Deaths</td>
      <td>Liberia</td>
    </tr>
  </tbody>
</table>
<p>488 rows × 8 columns</p>
</div>
