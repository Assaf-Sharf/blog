---
layout: single
title: "운영체제 7장"
categories: OS
tag: [OS, 이론]
redirect_from:
    - #/daily/first
---

# 교착상태
## 교착상태(Deadlock)의 개념
### Blocked/Asleep state
  - 프로세스가 특정 이벤트를 기다리는 상태
  - 프로세스가 필요한 자원을 기다리는 상태
### Deadlock state
- 프로세스가 발생 가능성이 없는 이벤트를 기다리는 경우
  - 프로세스가 교착상태에 있음
- 시스템 내에 교착상태에 빠진 프로세스가 있는 경우
  - 시스템이 교착상태에 있음

## 자원의 분류
- 일반적 분류
  - HW, SW
- 다른 분류 법
  - 선점 가능 여부
  - 할당 단위
  - 동시 사용 가능 여부
  - 재사용 가능 여부

### 선점 가능 여부에 따른 분류
- 선점 자원
  - 선점 당한 후, 돌아와도 문제가 발생하지 않는 자원
  - 프로세서, 메모리 등
- 비선점 자원
  - 선점 당하면, 이후 진행에 문제가 발생하는 자원
  - 디스크 드라이브 등

### 할당 단위에 따른 분류
- 전체 할당 자원
  - 자원 전체를 프로세스에게 할당
  - 프로세서, 디스크 드라이브 등
- 분할 할당 자원
  - 하나의 자원을 여러 조각으로 나누어 여러 프로세스들에게 할당
    - 메모리 등

### 동시 사용 가능 여부에 따른 분류
- 독점적 할당 자원
  - 한 순간에 한 프로세스만 사용 가능한 자원
  - 프로세서, 메모리, 디스크 드라이버 등
- 공유 할당 자원
  - 여러 프로세스가 동시에 사용 가능한 자원
  - 프로그램, 공유 데이터 등

### 재사용 가능 여부에 따른 분류
- SR (Serially-reuable Resource), 연속 사용 가능한 자원
  - 시스템 내에 항상 존재하는 자원
  - 사용이 끝나면 다른 프로세스가 사용 가능
  - 프로세서, 메모리, 디스크 드라이브, 프로그램 등
- CR (Consumable Resources), 소모 자원
  - 한 프로세스가 사용한 후에 사라지는 자원
  - signal, message 등

## 교착상태와 자원의 종류
- 교착상태를 발생시킬 수 있는 자원의 형태
  - 비선점 자원
    - 작업이 끝나기 전까지 작업함
  - 독점적 할당 자원
    - 혼자 자원을 사용
  - 연속 사용 가능한 자원

## 교착상태 발생 필요 조건
- 아래 특징을 **모두** 충족해야함
- 자원의 특징
  - 독점적 할당 자원
  - 비선점 자원
- 프로세스의 특징
  - Hold and wait, 부분할당
    - 자원을 하나 hold하고 다른 자원 요청
  - circle wait
    - A프로세스가 B프로세스를 필요로 하고 B프로세스가 C프로세스, C프로세스가 A프로세스를 필요로 함

## 교착상태 해결 방법
- 교착살태 예방
- 교착상태 회피
- 교착상태 탐지 및 복구

### 교착상태 예방
- 4개의 교착상태 필요 조건 중 하나를 제거
- 교착상태가 절대 발생하지 않음
- 심각한 자원 낭비 발생
- 비현실적


1. 모든 자원을 공유 혀용
   - 독점적 할당 자원 조건 제거
   - 현실적으로 불가능
2. 모든 자원에 대해 선점 허용
   - 비선점 자원 조건 제거
   - 현실적으로 불가능
3. 필요 자원 한번에 모두 할당
   - Hold and wait 조건 제거
   - 자원 낭비 발생
     - 필요하지 않은 순간에도 가지고 있음
   - 무한 대기 현상 발생 가능
4. Circular wait 조건 제거
   - 전체 할당을 일반화한 방법
   - 자원들에게 순서를 부여
   - 프로세스는 순서의 증가 방향으로만 자원 요청 가능
   - 자원 낭비 발생

### 교착상태 회피
- 시스템의 상태를 계속 감시
- 시스템이 교착상태가 될 가능성이 있는 자원 할당 요청 보류
- 시스템을 항상 safe state로 유지
  - safe state
    - 모든 프로세스가 정상적 종료가 가능한 상태
    - sage sequence가 존재
      - 교착상태가 되지 않을 수 있음을 보장
  - unsafe state
    - 교착상태가 될 가능성이 있음
- 단점
  - High overhead
    - 항상 시스템을 감시하고 있어야 함
  - Low resource utilization
    - safe state 유지를 위해, 사용되지 않는 자원이 존재

### 교착상태 탐지 및 복구
- 교착상태 방지를 위한 사전 작업 x
  - 교착상태가 발생 가능
- 주기적으로 교착상태 발생 확인
- Resource Allocation Graph (RAG) 사용
- High overhead
  - 검사 주기에 영향을 받음
  - Node의 수가 많은 경우 커짐

### 교착상태 회피 vs 탐지 및 복구
- 교착상태 회피
  - 최악의 경우를 생각
    - 앞으로 일어날 일을 고려
  - 교착상태가 발생하지 않음
- 교착상태 탐지 및 복구
  - 최선의 경우를 생각
    - 현재 상태만 고려
  - 교착상태 발생 시 회복 과정이 필요