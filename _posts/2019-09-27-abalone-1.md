---
layout: single
title: Abalone. Part 1
author-id: Chingis Maksimov
tags: [machine learning, data science, tutorial]
classes: wide
---

This is the first in a series of posts about constructing a predictive model, based on physical measurements, of age of abalone, where abalone referes to a group of sea snails. In this post, we are going to go over the dataset and provide some descriptive statistics. The dataset that we are going to use and other related information can be accessed from the [UCI Machine Learning Repository](https://archive.ics.uci.edu/ml/datasets/Abalone). Note that this dataset has been originally collected in relation to a non-machine-learning study (Nash et al., 1994).

Before we start our analysis, let us import all the required Python libraries and load our dataset as pandas dataframe.


```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import math

column_names = ["sex", "length", "diameter", "height", "whole_weight", "shucked_weight", "viscera_weight",
                "shell_weight", "rings"]
dataset = pd.read_csv("abalone.data", names=column_names)

dataset.head()
```



<div class="p-Widget jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output" data-mime-type="text/html">
<style scoped>

    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>length</th>
      <th>diameter</th>
      <th>height</th>
      <th>whole_weight</th>
      <th>shucked_weight</th>
      <th>viscera_weight</th>
      <th>shell_weight</th>
      <th>rings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>M</td>
      <td>0.455</td>
      <td>0.365</td>
      <td>0.095</td>
      <td>0.5140</td>
      <td>0.2245</td>
      <td>0.1010</td>
      <td>0.150</td>
      <td>15</td>
    </tr>
    <tr>
      <td>1</td>
      <td>M</td>
      <td>0.350</td>
      <td>0.265</td>
      <td>0.090</td>
      <td>0.2255</td>
      <td>0.0995</td>
      <td>0.0485</td>
      <td>0.070</td>
      <td>7</td>
    </tr>
    <tr>
      <td>2</td>
      <td>F</td>
      <td>0.530</td>
      <td>0.420</td>
      <td>0.135</td>
      <td>0.6770</td>
      <td>0.2565</td>
      <td>0.1415</td>
      <td>0.210</td>
      <td>9</td>
    </tr>
    <tr>
      <td>3</td>
      <td>M</td>
      <td>0.440</td>
      <td>0.365</td>
      <td>0.125</td>
      <td>0.5160</td>
      <td>0.2155</td>
      <td>0.1140</td>
      <td>0.155</td>
      <td>10</td>
    </tr>
    <tr>
      <td>4</td>
      <td>I</td>
      <td>0.330</td>
      <td>0.255</td>
      <td>0.080</td>
      <td>0.2050</td>
      <td>0.0895</td>
      <td>0.0395</td>
      <td>0.055</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>



As the first step, we should have a look at the description of the dataset and get a rough idea about what we are dealing with. According to the metadata, the dataset contains 4,177 labeled observations. Predictor or independent variables are all either real-valued or integer, overall 8 in number. The target or dependent variable is integer-valued and signifies the number of rings that a given abalone has. By adding 1.5 to the number of rings one can judge about the age of the ablaone.

It is worth mentioning that there are no missing values for this dataset (observations with missing data points have been excluded from the dataset we get to work with). This significantly reduces work load and minimizes room for error as fewer assumptions need to be made about how to treat observations with missing values. Also, there are no experts to consult with and ask for their professional opinion.

Numeric predictor variables have been standardized beforehand to facilitate analysis and are pretty self-explanatory. Thus, we are not going to waste too much time going over what each one of them means exactly. However, we can observe that there 4 distinct weight measures. According to the dataset description, whole weight refers to the whole abalone, shucked weight refers to the weight of meat, viscera weight refers to the gut weight (after bleeding) and shell weight is weight after being dried.

We further observe that sex variable is of nominal type. It has 3 distinct values: M for male, F for female and I for infant. Due to its type, this variable cannot be directly used by most of the predictive models, like regression, neural networs, etc. For that reason, we need to transform it to a numeric type. There are a number of ways in which this can be accomplished. For example, we could introduce dummy variables. This approach would allow us to better separate instances belonging to different sexes at the price of increased degrees of freedom. Or, alternatively, we could just use a numeric encoding scheme. Numeric encoding leaves the number of attributes unchanged but we are running the risk that certain models may incorrectly interpret classes that have closer encoding as being similar in their interpretations. For that reason, let us check if there is a clear difference in the number of rings for different sexes.


```python
pd.pivot_table(dataset, values="rings", columns="sex", aggfunc=np.mean)
```




<div class="p-Widget jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output" data-mime-type="text/html">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>sex</th>
      <th>F</th>
      <th>I</th>
      <th>M</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>rings</td>
      <td>11.13</td>
      <td>7.89</td>
      <td>10.71</td>
    </tr>
  </tbody>
</table>
</div>



It comes as no surprise that the average number of rings for infant abalone is smaller than that of grown abalone. For grown female and male abalone, the average number of rings looks to be about equal. Thus, we could transform sex variable into another variable that will have two values: "infant" and "grown". However, by doing this, we might get in trouble if sex variable correlates with other predictor variables. To avoid any of the mentioned problems, we will introduce dummy variables and keep all 3 distinct values.


```python
dataset = pd.concat([pd.get_dummies(dataset.sex, prefix='sex'), dataset.drop(['sex'], axis=1)], axis=1)
dataset.head()
```




<div class="p-Widget jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output" data-mime-type="text/html">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex_F</th>
      <th>sex_I</th>
      <th>sex_M</th>
      <th>length</th>
      <th>diameter</th>
      <th>height</th>
      <th>whole_weight</th>
      <th>shucked_weight</th>
      <th>viscera_weight</th>
      <th>shell_weight</th>
      <th>rings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0.455</td>
      <td>0.365</td>
      <td>0.095</td>
      <td>0.5140</td>
      <td>0.2245</td>
      <td>0.1010</td>
      <td>0.150</td>
      <td>15</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0.350</td>
      <td>0.265</td>
      <td>0.090</td>
      <td>0.2255</td>
      <td>0.0995</td>
      <td>0.0485</td>
      <td>0.070</td>
      <td>7</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.530</td>
      <td>0.420</td>
      <td>0.135</td>
      <td>0.6770</td>
      <td>0.2565</td>
      <td>0.1415</td>
      <td>0.210</td>
      <td>9</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0.440</td>
      <td>0.365</td>
      <td>0.125</td>
      <td>0.5160</td>
      <td>0.2155</td>
      <td>0.1140</td>
      <td>0.155</td>
      <td>10</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.330</td>
      <td>0.255</td>
      <td>0.080</td>
      <td>0.2050</td>
      <td>0.0895</td>
      <td>0.0395</td>
      <td>0.055</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>



Next we are going to have a look at descriptive statistics for the variables in the dataset.


```python
dataset.describe()
```




<div class="p-Widget jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output" data-mime-type="text/html">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex_F</th>
      <th>sex_I</th>
      <th>sex_M</th>
      <th>length</th>
      <th>diameter</th>
      <th>height</th>
      <th>whole_weight</th>
      <th>shucked_weight</th>
      <th>viscera_weight</th>
      <th>shell_weight</th>
      <th>rings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>4177</td>
      <td>4177</td>
      <td>4177</td>
      <td>4177</td>
      <td>4177</td>
      <td>4177</td>
      <td>4177</td>
      <td>4177</td>
      <td>4177</td>
      <td>4177</td>
      <td>4177</td>
    </tr>
    <tr>
      <td>mean</td>
      <td>0.312904</td>
      <td>0.321283</td>
      <td>0.365813</td>
      <td>0.523992</td>
      <td>0.407881</td>
      <td>0.139516</td>
      <td>0.828742</td>
      <td>0.359367</td>
      <td>0.180594</td>
      <td>0.238831</td>
      <td>9.933684</td>
    </tr>
    <tr>
      <td>std</td>
      <td>0.463731</td>
      <td>0.467025</td>
      <td>0.481715</td>
      <td>0.120093</td>
      <td>0.099240</td>
      <td>0.041827</td>
      <td>0.490389</td>
      <td>0.221963</td>
      <td>0.109614</td>
      <td>0.139203</td>
      <td>3.224169</td>
    </tr>
    <tr>
      <td>min</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.075000</td>
      <td>0.055000</td>
      <td>0.000000</td>
      <td>0.002000</td>
      <td>0.001000</td>
      <td>0.000500</td>
      <td>0.001500</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.450000</td>
      <td>0.350000</td>
      <td>0.115000</td>
      <td>0.441500</td>
      <td>0.186000</td>
      <td>0.093500</td>
      <td>0.130000</td>
      <td>8.000000</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.545000</td>
      <td>0.425000</td>
      <td>0.140000</td>
      <td>0.799500</td>
      <td>0.336000</td>
      <td>0.171000</td>
      <td>0.234000</td>
      <td>9.000000</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.615000</td>
      <td>0.480000</td>
      <td>0.165000</td>
      <td>1.153000</td>
      <td>0.502000</td>
      <td>0.253000</td>
      <td>0.329000</td>
      <td>11.000000</td>
    </tr>
    <tr>
      <td>max</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.815000</td>
      <td>0.650000</td>
      <td>1.130000</td>
      <td>2.825500</td>
      <td>1.488000</td>
      <td>0.760000</td>
      <td>1.005000</td>
      <td>29.000000</td>
    </tr>
  </tbody>
</table>
</div>



As per above table, we have about equal distribution between female, male and infant abalone in the dataset. The average number of rings is about 10 while the median number of rings is 9. This means that the distribution of our target variable is skewed to the right and the longer right tail "pulls" the center of probability mass towards itself.

We can also observe that the smallest value for height variable is 0. Let us investigate these observations.


```python
dataset[(dataset.height==0)]
```




<div class="p-Widget jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output" data-mime-type="text/html">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex_F</th>
      <th>sex_I</th>
      <th>sex_M</th>
      <th>length</th>
      <th>diameter</th>
      <th>height</th>
      <th>whole_weight</th>
      <th>shucked_weight</th>
      <th>viscera_weight</th>
      <th>shell_weight</th>
      <th>rings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1257</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.430</td>
      <td>0.34</td>
      <td>0.0</td>
      <td>0.428</td>
      <td>0.2065</td>
      <td>0.0860</td>
      <td>0.1150</td>
      <td>8</td>
    </tr>
    <tr>
      <td>3996</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.315</td>
      <td>0.23</td>
      <td>0.0</td>
      <td>0.134</td>
      <td>0.0575</td>
      <td>0.0285</td>
      <td>0.3505</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



There are 2 observations with 0 height. While it is possible that the true recorded values for these observations got rounded down during data collection, we will treat them as erroneous and remove then from subsequent analysis.


```python
dataset = dataset[(dataset.height) != 0]
```

Having spotted some possible inaccuracies, we should investigate further and make sure that the remaining observations make sense to us. For example, we would expect the whole weight of abalone to be larger than constituent parts.


```python
dataset[(dataset.whole_weight <= dataset.shucked_weight) | (dataset.whole_weight <= dataset.viscera_weight) | (dataset.whole_weight <= dataset.shell_weight)]
```




<div class="p-Widget jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output" data-mime-type="text/html">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex_F</th>
      <th>sex_I</th>
      <th>sex_M</th>
      <th>length</th>
      <th>diameter</th>
      <th>height</th>
      <th>whole_weight</th>
      <th>shucked_weight</th>
      <th>viscera_weight</th>
      <th>shell_weight</th>
      <th>rings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1216</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.310</td>
      <td>0.225</td>
      <td>0.070</td>
      <td>0.1055</td>
      <td>0.4350</td>
      <td>0.0150</td>
      <td>0.0400</td>
      <td>5</td>
    </tr>
    <tr>
      <td>2627</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.275</td>
      <td>0.205</td>
      <td>0.070</td>
      <td>0.1055</td>
      <td>0.4950</td>
      <td>0.0190</td>
      <td>0.0315</td>
      <td>5</td>
    </tr>
    <tr>
      <td>2641</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.475</td>
      <td>0.365</td>
      <td>0.100</td>
      <td>0.1315</td>
      <td>0.2025</td>
      <td>0.0875</td>
      <td>0.1230</td>
      <td>7</td>
    </tr>
    <tr>
      <td>3086</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.355</td>
      <td>0.270</td>
      <td>0.075</td>
      <td>0.2040</td>
      <td>0.3045</td>
      <td>0.0460</td>
      <td>0.0595</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>



There are 4 observations for which this is not the case. In particular, for all 4 observations, shucked weight exceeds whole weight. We will be consistent in our treatment and assume that these are erroneous observations.


```python
dataset = dataset[(dataset.shucked_weight < dataset.whole_weight)]
```

Without expert knowledge, it is hard to make educated decisions about validity of "size" variables of abalone, i.e. length, diameter and height. Thus, for the purposes of this analysis, we will assume that all remaining observations are valid.

While descriptive statistics provides us with valuable information about our data, it is always important to have a look at visualizations as they can reveal patterns and connections that cannot be expressed in pure numeric fashion. We will start off by looking at distributions of each of the variables separately.


```python
dataset.hist(figsize=(15, 15), bins=40)
```


![png](/assets/img/posts/abalone/output_17_1.png)


As we previously suspected, the distribution of the target variable, rings, is slighly skewed to the right, i.e. the right tail is longer. At the same time, it roughly resembles a normal, bell-shaped distribution. This further means that we can treat this problem as a regression problem. All "weight" variables are also skewed to the right. The shapes of their respective distributions look similar to the shape of a lognormally distributed random variable. This futher hints at a possibility of using some kind of variable transformation to "normalize" the variables.

Diameter and length variables are, on the other hand, slightly left skewed with distribution shapes resembling closely a normal distribution. These variables are in no need of any special preprocessing.

Correlation and bivariate analyses are a natural continuation of a univariate analysis. We are going to create a correlation matrix in what follows.


```python
corr = dataset.corr()
corr
```




<div class="p-Widget jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output" data-mime-type="text/html">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex_F</th>
      <th>sex_I</th>
      <th>sex_M</th>
      <th>length</th>
      <th>diameter</th>
      <th>height</th>
      <th>whole_weight</th>
      <th>shucked_weight</th>
      <th>viscera_weight</th>
      <th>shell_weight</th>
      <th>rings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>sex_F</td>
      <td>1.000000</td>
      <td>-0.463744</td>
      <td>-0.513647</td>
      <td>0.308932</td>
      <td>0.317916</td>
      <td>0.297608</td>
      <td>0.298946</td>
      <td>0.263853</td>
      <td>0.307707</td>
      <td>0.305885</td>
      <td>0.249521</td>
    </tr>
    <tr>
      <td>sex_I</td>
      <td>-0.463744</td>
      <td>1.000000</td>
      <td>-0.521963</td>
      <td>-0.550321</td>
      <td>-0.563221</td>
      <td>-0.516913</td>
      <td>-0.556403</td>
      <td>-0.522132</td>
      <td>-0.554998</td>
      <td>-0.546525</td>
      <td>-0.434816</td>
    </tr>
    <tr>
      <td>sex_M</td>
      <td>-0.513647</td>
      <td>-0.521963</td>
      <td>1.000000</td>
      <td>0.235524</td>
      <td>0.239368</td>
      <td>0.214073</td>
      <td>0.251028</td>
      <td>0.251625</td>
      <td>0.241233</td>
      <td>0.234781</td>
      <td>0.180863</td>
    </tr>
    <tr>
      <td>length</td>
      <td>0.308932</td>
      <td>-0.550321</td>
      <td>0.235524</td>
      <td>1.000000</td>
      <td>0.986771</td>
      <td>0.827785</td>
      <td>0.925239</td>
      <td>0.899307</td>
      <td>0.902849</td>
      <td>0.898301</td>
      <td>0.555716</td>
    </tr>
    <tr>
      <td>diameter</td>
      <td>0.317916</td>
      <td>-0.563221</td>
      <td>0.239368</td>
      <td>0.986771</td>
      <td>1.000000</td>
      <td>0.833985</td>
      <td>0.925430</td>
      <td>0.894555</td>
      <td>0.899550</td>
      <td>0.905978</td>
      <td>0.573696</td>
    </tr>
    <tr>
      <td>height</td>
      <td>0.297608</td>
      <td>-0.516913</td>
      <td>0.214073</td>
      <td>0.827785</td>
      <td>0.833985</td>
      <td>1.000000</td>
      <td>0.819566</td>
      <td>0.776671</td>
      <td>0.798553</td>
      <td>0.819281</td>
      <td>0.556870</td>
    </tr>
    <tr>
      <td>whole_weight</td>
      <td>0.298946</td>
      <td>-0.556403</td>
      <td>0.251028</td>
      <td>0.925239</td>
      <td>0.925430</td>
      <td>0.819566</td>
      <td>1.000000</td>
      <td>0.970463</td>
      <td>0.966334</td>
      <td>0.955889</td>
      <td>0.539407</td>
    </tr>
    <tr>
      <td>shucked_weight</td>
      <td>0.263853</td>
      <td>-0.522132</td>
      <td>0.251625</td>
      <td>0.899307</td>
      <td>0.894555</td>
      <td>0.776671</td>
      <td>0.970463</td>
      <td>1.000000</td>
      <td>0.932912</td>
      <td>0.884058</td>
      <td>0.421111</td>
    </tr>
    <tr>
      <td>viscera_weight</td>
      <td>0.307707</td>
      <td>-0.554998</td>
      <td>0.241233</td>
      <td>0.902849</td>
      <td>0.899550</td>
      <td>0.798553</td>
      <td>0.966334</td>
      <td>0.932912</td>
      <td>1.000000</td>
      <td>0.908040</td>
      <td>0.502798</td>
    </tr>
    <tr>
      <td>shell_weight</td>
      <td>0.305885</td>
      <td>-0.546525</td>
      <td>0.234781</td>
      <td>0.898301</td>
      <td>0.905978</td>
      <td>0.819281</td>
      <td>0.955889</td>
      <td>0.884058</td>
      <td>0.908040</td>
      <td>1.000000</td>
      <td>0.627368</td>
    </tr>
    <tr>
      <td>rings</td>
      <td>0.249521</td>
      <td>-0.434816</td>
      <td>0.180863</td>
      <td>0.555716</td>
      <td>0.573696</td>
      <td>0.556870</td>
      <td>0.539407</td>
      <td>0.421111</td>
      <td>0.502798</td>
      <td>0.627368</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>



Let us investigate the resulting correlation matrix in more detail and see whether we can find some interesting patterns. We are especially interested in correlations between the dependent variable and predictor variables. First of all, we observe that there is a positive correlation between the number of rings and variables that represent "size" of abalone, i.e. length, diameter and height. The same applies to variables representing weight measures, whole weight, shucked weight, viscera weight and shell weight. This makes absolute sense as we would expect older abalone to be bigger, in terms of both weight and size, than younger abalone.

If we look at correlations between the number of rings and the dummy variables that we created for sex variable, we observe that there is negative correlation between the number of rings and the dummy variable representing whether a given abalone is an infant or not. At the same time, the correlations between the number of rings and other two dummy variables are very similar. Thus, in retrospect, we could have created a single variable that would just signify a grown abalone. However, we are going to keep 3 dummy variables and see how our model performs regardless.

While we considered how the dependent variable is related to the predictor variables, it is also important to consider if any two of the independent variables are correlated. Usually, when building predictive models, we try to avoid having highly correlated predictors. Note, however, that it becomes very tedious to go over each pair of variables in the above table. For that reason, we are going to create a simple heat map.


```python
mask = np.zeros_like(corr)
mask[np.triu_indices_from(mask)] = True
fig, ax = plt.subplots(figsize=(10,7))
sns.heatmap(corr, ax=ax, mask=mask, cmap=sns.dark_palette("muted purple", input="xkcd"))
```




![png](/assets/img/posts/abalone/output_21_1.png)


According to the heat map, all the variables that concern size or weight of abalone are highly correlated. We can also observe that most of the variables are negatively correlated with the dummy variable representing infant abalone. Thus, we may speculate that this dummy variable is going to be very important in the predictor model that we are going to construct. The remaining dummy variables representing sex are moderately correlated with other predictor variables.

It looks like our data is pretty tidy which means that we can start to build some predictive models. We are going to cover some of the algorithms in the next post.


## References
Dua, D. and Graff, C. (2019). UCI Machine Learning Repository [http://archive.ics.uci.edu/ml]. Irvine, CA: University of California, School of Information and Computer Science.

Warwick J Nash, Tracy L Sellers, Simon R Talbot, Andrew J Cawthorn and Wes B Ford (1994). "The Population Biology of Abalone (Haliotis species) in Tasmania. I. Blacklip Abalone (H. rubra) from the North Coast and Islands of Bass Strait", Sea Fisheries Division, Technical Report No. 48 (ISSN 1034-3288).
