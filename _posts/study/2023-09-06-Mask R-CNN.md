---
layout: single
title: "Mask R-CNN"
permalink: /studies/paper/Mask R-CNN
tags: [Paper, Vision AI]
categories:
  - 📄 paper
use_math: true
---
우리는 객체 인스턴스 분할을 위한 개념적으로 간단하고, 유연하며, 일반적인 프레임워크를 제시한다. 우리의 접근 방식은 이미지 내 객체를 효율적으로 탐지하는 동시에 각 인스턴스에 대한 고품질 분할 마스크를 생성한다. Mask R-CNN이라고 불리는 이 방법은 기존의 경계 상자 인식을 위한 분기에 객체 마스크를 예측하는 분기를 추가함으로써 Faster R-CNN을 확장한다. Mask R-CNN은 훈련하기 간단하며 Faster R-CNN에 비해 작은 오버헤드만을 추가하고, 초당 5 프레임으로 작동한다. 또한, Mask R-CNN은 다른 태스크로 쉽게 일반화될 수 있는데, 예를 들어 같은 프레임워크에서 인간의 포즈를 추정할 수 있다. 우리는 COCO 챌린지의 세 가지 트랙인 인스턴스 분할, 경계 상자 객체 탐지, 사람 키포인트 탐지에서 모두 최고의 결과를 보여준다. 별도의 추가 기능 없이도, Mask R-CNN은 기존의 모든 단일 모델 항목들을 포함하여 COCO 2016 챌린지 우승자들보다 모든 태스크에서 더 우수한 성능을 보인다. 우리는 이 간단하고 효과적인 접근 방식이 인스턴스 수준 인식 연구에 있어 견고한 기준점을 제공하고, 미래 연구를 용이하게 할 것을 기대한다. 코드는 다음에서 사용할 수 있다: https://github.com/facebookresearch/Detectron.

1. 서론
주제: Mask R-CNN은 이미지 내 객체의 인스턴스 분할을 위한 프레임워크로, 객체 탐지와 각 인스턴스에 대한 고품질 분할 마스크를 동시에 생성한다.
중요성: 이전의 연구들과 달리, Mask R-CNN은 객체 탐지와 분할을 위한 통합된 솔루션을 제공한다.
Mask R-CNN 프레임워크: Faster R-CNN을 확장하여, 객체의 경계 상자 인식과 함께 각 객체에 대한 분할 마스크를 병렬로 예측한다.
RoIAlign: 기존 RoIPool의 문제점을 해결하기 위해 제안된 정렬 기법으로, 특징 맵과 네트워크 출력 간의 정확한 공간적 정렬을 유지한다.
범용성: Mask R-CNN은 다른 태스크에도 쉽게 일반화될 수 있으며, 사람의 포즈 추정과 같은 추가적인 태스크에 대해서도 높은 성능을 보인다.
Mask R-CNN은 객체 인스턴스 분할을 위한 개념적으로 단순하고 유연한 프레임워크입니다. 이 방법은 이미지 내 객체를 효율적으로 감지하면서 동시에 각 인스턴스에 대한 고품질의 분할 마스크를 생성합니다. Mask R-CNN은 Faster R-CNN을 확장하여 바운딩 박스 인식 브랜치와 병렬로 객체 마스크를 예측하는 브랜치를 추가합니다.
성능 향상을 위한 기술:
기존 기술 대비 개선점: Mask R-CNN은 이미지 내 객체를 효율적으로 감지하고 각 인스턴스에 대한 고품질의 분할 마스크를 생성하는 데 초점을 맞춥니다. 이는 기존의 Faster R-CNN을 확장한 것으로, 바운딩 박스 인식과 병렬로 객체 마스크를 예측합니다.
Mask R-CNN의 구조: Mask R-CNN은 Faster R-CNN에 기반하며, 추가적인 마스크 예측 브랜치를 포함합니다. 이 브랜치는 각각의 관심 영역(Region of Interest, RoI)에 대해 바이너리 마스크를 픽셀 단위로 예측합니다.
효율성과 일반화: Mask R-CNN은 훈련하기 쉽고 Faster R-CNN에 비해 작은 오버헤드만 추가합니다. 또한 다양한 작업으로 쉽게 일반화될 수 있어, 예를 들어 동일한 프레임워크 내에서 인간 자세 추정 같은 다른 과제에도 적용 가능합니다.
성능: Mask R-CNN은 COCO 도전 과제의 모든 세부 항목에서 최고의 결과를 보여주며, 기존의 단일 모델 항목을 모두 능가합니다. 특히 COCO 2016 도전 과제 우승자보다 뛰어난 성능을 보입니다​​.

2. Related Work
R-CNN 및 그 확장:
R-CNN: R-CNN은 객체 탐지를 위해 제한된 수의 후보 객체 영역(RoI)에 주목하고 각 RoI에 대해 독립적으로 합성곱 네트워크를 적용하는 방식입니다. 이는 정확도와 속도 향상을 가져왔습니다.
Faster R-CNN: Faster R-CNN은 R-CNN을 발전시켜 Region Proposal Network(RPN)를 통해 주의 집중 메커니즘을 학습합니다. 이는 유연성과 견고함을 갖추고 있으며, 여러 벤치마크에서 선두적인 프레임워크로 자리잡았습니다.
인스턴스 분할 방법론:
기존 접근법: 초기 방법들은 세그먼트 제안에 의존했습니다. DeepMask와 이후의 연구들은 세그먼트 후보를 제안하고 Fast R-CNN으로 분류하는 방식을 사용했습니다. 그러나 이 접근법은 인식보다 세분화에 먼저 집중하는 것으로, 속도가 느리고 정확도가 떨어지는 문제가 있었습니다.
FCIS의 한계: FCIS는 객체 클래스, 박스, 마스크를 동시에 다루는 위치-민감적 출력 채널을 전체적으로 예측하는 방식을 채택했습니다. 이 방법은 빠르지만, 인스턴스 간 겹침에 대한 시스템 오류와 가장자리 생성 문제를 드러냈습니다.
Mask R-CNN의 접근: Mask R-CNN은 '인스턴스 우선' 전략을 채택하여 마스크와 클래스 레이블을 병렬로 예측합니다. 이는 기존의 '세분화 우선' 전략과 대조되며, 더 단순하고 유연한 방법을 제공합니다.

3. Mask R-CNN
구조: Mask R-CNN은 두 개의 스테이지로 구성된다. 첫 번째는 객체 후보 영역을 제안하고, 두 번째는 각 RoI에 대해 클래스 라벨, 경계 상자 오프셋, 그리고 객체 마스크를 예측한다.
RoIAlign: 기존 RoIPool은 특징 맵과 출력 간의 공간적 정렬이 부정확하다. RoIAlign은 이를 해결하여 마스크의 정확도를 크게 향상시킨다.
네트워크 아키텍처: 다양한 아키텍처에서 Mask R-CNN을 구현하고 실험하였으며, 이를 통해 프레임워크의 범용성과 유연성을 입증한다.
Mask R-CNN의 개념적 단순성
기본 구조: Mask R-CNN은 Faster R-CNN에 기반하여, 후보 객체에 대해 클래스 레이블과 바운딩 박스 오프셋을 출력하는 두 가지 출력 외에도 객체 마스크를 출력하는 세 번째 브랜치를 추가합니다.
마스크 출력: 추가된 마스크 출력은 클래스와 박스 출력과 별개로, 객체의 더 세밀한 공간적 구조를 추출해야 합니다.
Faster R-CNN과의 연계
Faster R-CNN: 두 단계로 구성된 Faster R-CNN은 첫 번째 단계에서 RPN을 통해 후보 객체 바운딩 박스를 제안하고, 두 번째 단계에서는 RoIPool을 사용해 각 후보 상자에서 특징을 추출하고 분류 및 바운딩 박스 회귀를 수행합니다.
특징 공유: 두 단계 모두에서 사용되는 특징은 더 빠른 추론을 위해 공유될 수 있습니다.
Mask R-CNN의 핵심 요소
RoIAlign: Faster R-CNN의 주요 누락 요소인 픽셀 대 픽셀 정렬을 도입합니다. RoIPool의 엄격한 양자화를 제거하고 입력과 추출된 특징 간에 적절한 정렬을 달성합니다.
마스크 표현: 마스크는 객체의 공간적 레이아웃을 인코딩합니다. 이는 완전 연결(fc) 레이어에 의해 짧은 출력 벡터로 축소되는 클래스 레이블이나 박스 오프셋과는 달리, 컨볼루션을 통해 픽셀 대 픽셀 대응을 유지하면서 공간 구조를 추출할 수 있습니다.
구현 세부 사항
훈련: RoI는 IoU가 0.5 이상인 경우 긍정적으로 간주됩니다. 마스크 손실은 긍정적인 RoI에서만 정의됩니다.
인퍼런스: 테스트 시간에는 후보 제안 수가 C4 백본의 경우 300, FPN의 경우 1000으로 설정됩니다. 박스 예측 브랜치를 이들 제안에 적용한 후, 최고 점수를 받은 100개의 탐지 상자에 마스크 브랜치를 적용합니다.
이 섹션은 Mask R-CNN의 구조적인 특성과 구현에 대한 깊은 이해를 제공합니다. 특히, RoIAlign과 같은 혁신적인 요소는 Mask R-CNN을 인스턴스 분할에서 중요한 알고리즘으로 만드는 핵심 요소입니다. Mask R-CNN은 기존의 방법들과 비교하여 효율성과 정확성 면에서 상당한 개선을 보여줍니다.

4. 실험 결과 및 분석
COCO 데이터셋: COCO 데이터셋을 사용한 실험에서 Mask R-CNN은 인스턴스 분할, 경계 상자 객체 탐지, 사람 키포인트 탐지에서 모두 최고 성능을 달성한다.
Cityscapes 데이터셋: 도시 장면에서의 인스턴스 분할에도 Mask R-CNN은 높은 성능을 보여준다.
Ablation 연구: RoIAlign, 네트워크 아키텍처, 훈련 세부 사항 등 다양한 요소들의 영향을 분석하여 프레임워크의 각 구성 요소의 중요성을 입증한다.
실험 개요
데이터셋 및 메트릭: COCO 데이터셋에서 80k개의 훈련 이미지와 35k개의 검증 이미지 부분집합을 사용하여 훈련하고, 나머지 5k개의 검증 이미지(minival)에서 성능을 평가합니다. 표준 COCO 메트릭인 AP, AP50, AP75, APS, APM, APL을 사용하여 평가합니다.
주요 결과
성능 비교: Mask R-CNN은 이전 최고의 모델들을 능가합니다. 특히, ResNet-101-FPN 백본을 사용한 Mask R-CNN은 FCIS+++을 포함한 다른 모델들보다 우수한 성능을 보여줍니다.
강건성: Mask R-CNN은 도전적인 조건에서도 좋은 결과를 보여주며, FCIS+++와 비교할 때 겹치는 인스턴스에 대한 오류가 없음을 시각적으로 입증합니다.
Ablation 실험
아키텍처: 다양한 백본 아키텍처를 실험하여 FPN과 ResNeXt가 성능 향상에 기여함을 확인합니다.
마스크 예측 방식: Mask R-CNN은 클래스별 마스크 예측과 독립적인 마스크 예측 방식을 사용합니다. 이는 기존 FCN에서 사용되는 픽셀별 소프트맥스 방식과 달리 클래스 간 경쟁 없이 효율적인 훈련을 가능하게 합니다.
RoIAlign의 중요성: RoIAlign 계층은 Mask R-CNN에서 픽셀 정확한 마스크 예측에 중요한 역할을 합니다. 이는 기존의 RoIPool과 비교하여 성능 향상을 가져옵니다.
성능 및 훈련 시간
바운딩 박스 탐지 결과: Mask R-CNN은 객체 탐지에서도 최고의 성능을 보여줍니다. 특히, 멀티태스크 훈련의 이점으로 인해 Mask R-CNN은 바운딩 박스 탐지에서도 강력한 성능을 발휘합니다.
효율적인 훈련과 추론: Mask R-CNN은 훈련 속도가 빠르며, 추론 시간도 경쟁력이 있습니다. 이는 인스턴스 분할 연구의 큰 장벽을 줄이고 더 많은 연구를 장려할 수 있습니다.
이 실험 섹션을 통해 Mask R-CNN이 인스턴스 분할 분야에서 얼마나 강력한 성능을 발휘하는지를 명확히 보여줍니다. 동시에 다양한 네트워크 구조와 훈련 방법에 대한 깊은 이해와 통찰력을 제공하여, 이 분야의 연구 및 개발에 중요한 가이드라인을 제시합니다.

5. 결론
Mask R-CNN의 중요성: 이 연구는 인스턴스 수준의 인식 작업에 대한 새로운 접근 방식을 제시하며, 향후 연구에 있어서 강력한 기준점을 제공한다.
향후 연구 방향: Mask R-CNN의 프레임워크는 다양한 연구 분야와 태스크에 적용될 수 있는 유연성을 가지고 있으며, 추가적인 연구를 통해 더욱 발전될 수 있을 것이다.
Mask R-CNN의 인간 자세 추정 적용
키포인트 모델링: 각각의 키포인트(예: 왼쪽 어깨, 오른쪽 팔꿈치)는 하나의 핫 마스크로 모델링됩니다. Mask R-CNN은 K개의 키포인트 유형 각각에 대해 K개의 마스크를 예측합니다.
유연성: 이 접근 방식은 Mask R-CNN의 범용성과 유연성을 보여주며, 인간 자세에 대한 최소한의 도메인 지식만을 활용합니다.
구현 세부 사항
아키텍처 변경: 키포인트를 위해 세그멘테이션 시스템에 약간의 수정을 가했습니다. 각 인스턴스의 K개 키포인트에 대해, 훈련 목표는 단일 픽셀만 전경으로 표시된 m×m 바이너리 마스크입니다.
훈련 과정: 훈련 중에는 m2-방향 소프트맥스 출력에 대한 교차 엔트로피 손실을 최소화하여 단일 키포인트를 탐지하도록 합니다.
키 포인트 헤드: ResNet-FPN 변형을 채택하고, 키포인트 헤드 구조는 Figure 4(오른쪽)와 유사합니다. 이는 고해상도 출력을 필요로 하는 키포인트 수준의 위치 정확도를 위해 설계되었습니다.
주요 결과 및 Ablation 실험
성능 평가: ResNet-50-FPN 백본으로 실험한 결과, COCO 2016 키포인트 탐지 우승자보다 0.9 포인트 높은 62.7 APkp를 달성했습니다.
통합 모델의 이점: 이 모델은 박스, 세그먼트, 키포인트를 동시에 예측할 수 있으며, 초당 5프레임의 속도로 실행됩니다. 세그먼트 분기를 추가하면 APkp가 63.1로 향상됩니다.
RoIAlign의 효과: RoIAlign은 키포인트 탐지에 있어서도 RoIPool보다 뛰어난 성능을 보여주며, APkp를 4.4 포인트 향상시킵니다.
이 섹션은 Mask R-CNN이 단순히 객체 인스턴스 분할에 국한되지 않고, 인간 자세 추정과 같은 다른 인스턴스 수준의 태스크에도 효과적으로 확장될 수 있음을 보여줍니다. 키포인트 탐지의 정확성과 이를 위한 아키텍처의 적응성은 Mask R-CNN의 범용성과 유연성을 강조합니다. 이러한 점은 인공지능 전공자들에게 이 기술의 다양한 응용 가능성을 제시합니다.