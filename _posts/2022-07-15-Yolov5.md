---
layout: single
title:  "YOLO V5 구현"
categories : yolo
tag : [ultratics, object-detection, Yolo, 딥러닝]
toc: true
toc_sticky: true

---

![header](https://capsule-render.vercel.app/api?type=waving&color=a2dcec&height=300&section=header&text=YOLO V5 구현&fontSize=40&animation=fadeIn&fontAlignY=38&fontColor=FFFFFF)



- 데이터는 roboflow 사용
- 최종결과 확인 및 정리


- 사용할 데이터셋 [세포 데이터 셋](https://public.roboflow.com/object-detection/bccd)

&nbsp;

## Yolo v5 가져오기


```python
!git clone https://github.com/ultralytics/yolov5  # clone
%cd yolov5
%pip install -qr requirements.txt  # install

import torch
import utils
display = utils.notebook_init()  # checks


>> YOLOv5 🚀 v6.1-295-gf8722b4 Python-3.7.13 torch-1.11.0+cu102 CUDA:0 (Tesla P100-PCIE-16GB, 16281MiB) Setup complete ✅ (4 CPUs, 25.5 GB RAM, 41.3/166.8 GB disk)
   
```


- Yolo v5 종속성 패키지 설치 


```python
%pip install -qr requirements.txt  
```

&nbsp;

## 데이터셋 다운

- roboflow 데이터셋 에서 format을 yolov5로 설정





```python
import os
os.mkdir('new_data')
os.chdir('new_data')

!curl -L "https://public.roboflow.com/ds/LiqNCw2nxu?key=JGcsrO8gpA" > roboflow.zip; unzip roboflow.zip; rm roboflow.zip
```


&nbsp;

## yaml 파일 확인


```python
os.getcwd()

>> '/content/yolov5/new_data'
```

&nbsp;


```python
import yaml

with open('data.yaml') as f:
  yaml_data = yaml.load(f, Loader=yaml.FullLoader)
```

- yolov5 폴더를 기준으로 경로 설정


```python
yaml_data['train'] = './new_data/train/images'
yaml_data['val'] = './new_data/valid/images'
```


```python
with open('data.yaml', 'w') as f:
  yaml.dump(yaml_data, f)

os.chdir('..')
```

&nbsp;

## 모델 훈련


```python
!python ./train.py --img 640 --batch 16 --epochs 30 --data ./new_data/data.yaml --weights yolov5s.pt --cache
```


&nbsp;

##  TEST 수행 

- 저장된 가중치 경로, test 이미지셋 경로



```python
os.getcwd()
>> '/content/yolov5'
```




```python
!python ./detect.py --weights ./runs/train/exp/weights/best.pt --img 640 --conf 0.25 --line-thickness 1 --source ./new_data/test/images 
```


&nbsp;

## Yolo v5 모델 결과 확인


```python
from glob import glob 
import cv2
from google.colab.patches import cv2_imshow

data_list = glob('./runs/detect/exp/*.jpg')
for i in data_list[:10]:
  src = cv2.imread(i)

  cv2_imshow(src)
```

![image-20220715101117628](/images/2022-07-15-Yolov5/image-20220715101117628.png)

